wpa._callhistorydetails=function(){function t(t){try{common.PutToDebugLog(4,"EVENT, _callhistorydetails: onCreate"),j$(window).resize(function(){"page_callhistorydetails"===j$.mobile.activePage.attr("id")&&o()}),j$("#callhistorydetails_menu_ul").on("click","li",function(t){s(j$(this).attr("id"))}),j$("#btn_callhistorydetails_menu").on("click",function(){l("#callhistorydetails_menu_ul")}),j$("#btn_callhistorydetails_menu").attr("title",stringres.get("hint_menu"))}catch(e){common.PutToDebugLogException(2,"_callhistorydetails: onCreate",e)}}function e(t){try{common.PutToDebugLog(4,"EVENT, _callhistorydetails: onStart"),global.isCallhistorydetailsStarted=!0,j$(".separator_line_thick").css("background-color",common.HoverCalc(common.getBgColor("#page_callhistorydetails"),-30)),common.isNull(document.getElementById("callhistorydetails_title"))||(document.getElementById("callhistorydetails_title").innerHTML=stringres.get("chdetails_title")),j$("#callhistorydetails_title").attr("title",stringres.get("hint_page")),common.isNull(document.getElementById("chdetails_btnback"))||(document.getElementById("chdetails_btnback").innerHTML="<b>&LT;</b>&nbsp;"+stringres.get("chdetails_btnback_txt")),o();try{g=common.StrToInt(common.GetIntentParam(global.intentchdetails,"ctid"))}catch(e){common.PutToDebugLogException(2,"_callhistorydetails: onStart can't convert ctid to INT",e)}h=global.chlist[g],i()}catch(e){common.PutToDebugLogException(2,"_callhistorydetails: onStart",e)}}function o(){try{j$("#page_callhistorydetails").css("min-height","auto");var t=common.GetDeviceHeight()-j$("#callhistorydetails_header").height();t-=3,j$("#page_callhistorydetails_content").height(t)}catch(e){common.PutToDebugLogException(2,"_callhistorylist: MeasureCallhistorydetails",e)}}function i(){try{if(common.isNull(h)||h.length<1)return void common.PutToDebugLog(2,"ERROR, _callhistorydetails PopulateData entry is NULL");j$("#page_callhistorydetails_content").html("");var t='<div id="ch_contact_name">'+h[common.CH_NAME]+"</div>",e=h[common.CH_NUMBER],o=h[common.CH_TYPE],i="";i="0"===o?stringres.get("ch_outgoing"):"1"===o?stringres.get("ch_incoming"):stringres.get("ch_missed");var n="icon_call.png",a="icon_message.png",l="btn_video_txt.png";if(22!==common.GetColortheme()&&23!==common.GetColortheme()||(n="icon_call_grey.png",a="icon_message_grey.png",l="btn_video_txt_grey.png"),!common.isNull(e)&&e.length>0){var s='<div id="ch_entry" class="ch_container"><div id="ch_call_entry" class="ch_call"><div class="ch_data"><div class="ch_type">'+i+'</div><div class="ch_number">'+h[common.CH_NUMBER]+'</div></div><div class="ch_icon"><img src="'+common.GetElementSource()+"images/"+n+'" /></div></div></div>',m='<div id="ch_entry" class="ch_container"><div id="ch_msg_entry" class="ch_call"><div class="ch_data"><div class="ch_type">'+stringres.get("send_msg")+'</div><div class="ch_number">'+h[common.CH_NUMBER]+'</div></div><div class="ch_icon"><img src="'+common.GetElementSource()+"images/"+a+'" /></div></div></div>',r="";("1"===common.GetParameter2("video")||"-1"===common.GetParameter2("video")&&common.getuseengine()===global.ENGINE_WEBRTC)&&(r='<div id="ch_entry" class="ch_container"><div id="ch_video_entry" class="ch_call"><div class="ch_data"><div class="ch_type">'+stringres.get("video_call")+'</div><div class="ch_number">'+h[common.CH_NUMBER]+'</div></div><div class="ch_icon"><img src="'+common.GetElementSource()+"images/"+l+'" /></div></div></div>'),!0!==common.HideSettings("chat",stringres.get("sett_display_name_chat"),"chat",!0)&&3!=common.GetParameterInt("chatsms",0)||(m=""),!1===common.CanIUseVideo()&&(r=""),t=t+s+m+r}j$("#page_callhistorydetails_content").html(t),!common.isNull(e)&&e.length>0&&(j$("#ch_call_entry").on("click",function(){c(0)}),j$("#ch_msg_entry").on("click",function(){c(1)}),j$("#ch_video_entry").on("click",function(){c(2)}))}catch(d){common.PutToDebugLogException(2,"_callhistorydetails: PopulateData",d)}}function c(t){try{if(u)return;u=!0,setTimeout(function(){u=!1},1e3),0===t?n(!1):1===t?a():2===t&&n(!0)}catch(e){common.PutToDebugLogException(2,"_callhistorydetails: OnItemClick",e)}}function n(t){try{common.SaveParameter("redial",h[common.CH_NUMBER]),common.PutToDebugLog(4,"EVENT, _callhistorydetails initiate call to: "+h[common.CH_NUMBER]),setTimeout(function(){!0===t?webphone_api.videocall(h[common.CH_NUMBER]):webphone_api.call(h[common.CH_NUMBER],-1)},100),j$.mobile.back()}catch(e){common.PutToDebugLogException(2,"_callhistorydetails: StartCall",e)}}function a(){try{common.StartMsg(h[common.CH_NUMBER],"","_callhistorydetails")}catch(t){common.PutToDebugLogException(2,"_callhistorydetails: StartChatSms",t)}}function l(t){try{return common.IsWindowsSoftphone()&&j$("#btn_callhistorydetails_menu").removeAttr("data-transition"),common.isNull(t)||t.lenght<1?void common.PutToDebugLog(2,"ERROR, _callhistorydetails: CreateOptionsMenu menuid null"):j$(t).length<=0?void common.PutToDebugLog(2,"ERROR, _callhistorydetails: CreateOptionsMenu can't get reference to Menu"):("#"!==t.charAt(0)&&(t="#"+t),j$(t).html(""),common.GetContactIdFromNumber(h[common.CH_NUMBER])<0?j$(t).append('<li id="'+y+'"><a data-rel="back">'+stringres.get("menu_createcontact")+"</a></li>").listview("refresh"):j$(t).append('<li id="'+p+'"><a data-rel="back">'+stringres.get("menu_editcontact")+"</a></li>").listview("refresh"),j$(t).append('<li id="'+v+'"><a data-rel="back">'+stringres.get("menu_call")+"</a></li>").listview("refresh"),!1!==common.HideSettings("chat",stringres.get("sett_display_name_chat"),"chat",!0)&&3!=common.GetParameterInt("chatsms",0)||j$(t).append('<li id="'+b+'"><a data-rel="back">'+stringres.get("menu_message")+"</a></li>").listview("refresh"),!0)}catch(e){common.PutToDebugLogException(2,"_callhistorydetails: CreateOptionsMenu",e)}return!1}function s(t){try{if(common.isNull(t)||t.length<1)return;j$("#callhistorydetails_menu").on("popupafterclose",function(e){switch(j$("#callhistorydetails_menu").off("popupafterclose"),t){case y:m();break;case p:r();break;case v:n();break;case b:a()}})}catch(e){common.PutToDebugLogException(2,"_callhistorydetails: MenuItemSelected",e)}}function m(){try{global.intentaddeditct[0]="action=add",global.intentaddeditct[1]="numbertoadd="+h[common.CH_NUMBER];var t=h[common.CH_NAME];(common.isNull(t)||t.length<1||t===h[common.CH_NUMBER])&&(t=""),global.intentaddeditct[2]="nametoadd="+t,j$.mobile.changePage("#page_addeditcontact",{transition:"pop",role:"page"})}catch(e){common.PutToDebugLogException(2,"_callhistorydetails: CreateContact",e)}}function r(){try{var t=common.GetContactIdFromNumber(h[common.CH_NUMBER]);if(t<0)return void m();global.intentaddeditct[0]="action=edit",global.intentaddeditct[1]="ctid="+t,j$.mobile.changePage("#page_addeditcontact",{transition:"pop",role:"page"})}catch(e){common.PutToDebugLogException(2,"_callhistorydetails: EditContact",e)}}function d(t){try{common.PutToDebugLog(4,"EVENT, _callhistorydetails: onStop"),global.isCallhistorydetailsStarted=!1,j$("#page_callhistorydetails_content").html("")}catch(e){common.PutToDebugLogException(2,"_callhistorydetails: onStop",e)}}function _(t){}var g=-1,h=null,u=!1,y="#menuitem_callhistorydetails_create",p="#menuitem_callhistorydetails_edit",v="#menuitem_callhistorydetails_call",b="#menuitem_callhistorydetails_message";return{onCreate:t,onStart:e,onStop:d,onDestroy:_}}();