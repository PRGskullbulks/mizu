wpa._contactslist=function(){function t(t){try{common.PutToDebugLog(4,"EVENT, _contactslist: onCreate"),j$("#nav_ct_dialpad").on("click",function(){j$.mobile.changePage("#page_dialpad",{transition:"none",role:"page",reverse:"true"})}),j$("#nav_ct_callhistory").on("click",function(){j$.mobile.changePage("#page_callhistorylist",{transition:"none",role:"page"})}),j$("#nav_ct_dialpad").attr("title",stringres.get("hint_dialpad")),j$("#nav_ct_contacts").attr("title",stringres.get("hint_contacts")),j$("#nav_ct_callhistory").attr("title",stringres.get("hint_callhistory")),j$("#status_contactslist").attr("title",stringres.get("hint_status")),j$("#curr_user_contactslist").attr("title",stringres.get("hint_curr_user")),j$("#contactslist_not_btn").on("click",function(){common.SaveParameter("notification_count2",0),common.ShowNotifications2()}),j$("#contactslist_list").on("click","li",function(t){c(j$(this).attr("id"))}),j$("#contactslist_list").on("taphold","li",function(t){l(j$(this).attr("id"))}),j$(window).resize(function(){"page_contactslist"===j$.mobile.activePage.attr("id")&&e()}),j$("#contactslist_menu_ul").on("click","li",function(t){_(j$(this).attr("id"))}),j$("#btn_contactslist_menu").on("click",function(){p("#contactslist_menu_ul")}),j$("#btn_contactslist_menu").attr("title",stringres.get("hint_menu"));var o=common.GetParameter("advertisement");if(!common.isNull(o)&&o.length>5&&(j$("#advert_contactslist_frame").attr("src",o),j$("#advert_contactslist").show()),!0===common.GetParameterBool("contacttoggle",!1)){var n=document.getElementById("togglecontact_container");common.isNull(n)||(n.style.display="block")}j$("select#togglecontact").change(function(){var t=!1,o=j$(this).val();common.isNull(o)||"on"!=o||(t=!0),a(t)}),!0===common.UsePresence2()&&(j$("#contactslist_additional_header_left").on("click",function(){common.PresenceSelector("contactslist")}),j$("#contactslist_additional_header_left").css("cursor","pointer")),j$("#page_contactslist").keydown(function(t){try{27===(t.keyCode?t.keyCode:t.which)&&j$("#contactslist_list").prev("form").find("input[data-type=search]").val("").trigger("change")}catch(o){common.PutToDebugLogException(2,"_contactslist: keydown",o)}})}catch(i){common.PutToDebugLogException(2,"_contactslist: onCreate",i)}}function o(t){try{if(common.PutToDebugLog(4,"EVENT, _contactslist: onStart"),global.isContactslistStarted=!0,common.HideSettings("page_history","","page_history",!0)){j$("#li_nav_ct_ch").remove();var o=j$("#ul_nav_ct").children().length,i=Math.floor(100/o);j$("#ul_nav_ct").children("li").each(function(){j$(this).css("width",i+"%")}),o<2&&(j$("#ul_nav_ct").remove(),MeasureDialPad())}common.GetParameter("devicetype")!==common.DEVICE_WIN_SOFTPHONE()&&(document.getElementById("app_name_contactslist").innerHTML=common.GetBrandName()),j$("#contactslist_list").attr("data-filter-placeholder",stringres.get("ct_search_hint")),common.isNull(document.getElementById("ctlist_title"))||(document.getElementById("ctlist_title").innerHTML=stringres.get("ctlist_title")),j$("#ctlist_title").attr("title",stringres.get("hint_page"));var a=common.GetCallerid();!common.isNull(a)&&a.length>0&&j$("#curr_user_contactslist").html(a);var c=common.GetDeviceWidth()-j$("#curr_user_contactslist").width()-25;if(!common.isNull(c)&&common.IsNumber(c)&&j$("#status_contactslist").width(c),j$(".separator_line_thick").css("background-color",common.HoverCalc(common.getBgColor("#page_contactslist"),-30)),common.GetParameter("header").length>2?(j$("#headertext_contactslist").show(),j$("#headertext_contactslist").html(common.GetParameter("header"))):j$("#headertext_contactslist").hide(),common.GetParameter("footer").length>2?(j$("#footertext_contactslist").show(),j$("#footertext_contactslist").html(common.GetParameter("footer"))):j$("#footertext_contactslist").hide(),j$("#contactslist_notification_list").on("click",".nt_anchor",function(t){j$("#contactslist_not").panel("close"),common.NotificationOnClick2(j$(this).attr("id"),!1)}),j$("#contactslist_notification_list").on("click",".nt_menu",function(t){j$("#contactslist_not").panel("close"),common.NotificationOnClick2(j$(this).attr("id"),!0)}),22===common.GetColortheme()&&(j$("#nav_ct_dialpad IMG").attr("src","images/tab_dialpad_grey.png"),j$("#nav_ct_contacts IMG").attr("src","images/tab_contacts_blue.png"),j$("#nav_ct_callhistory IMG").attr("src","images/tab_callog_grey.png")),58===common.GetConfigInt("brandid",-1)){var l=document.getElementById("app_name_contactslist");if(!common.isNull(l)){var s=document.getElementById("ctlist_title");l.style.display="inline",common.isNull(s)||(s.style.display="none"),document.getElementById("contactslist_additional_header_left").style.width="65%",l.innerHTML='<img src="'+common.GetElementSource()+'images/logo.png" style="border: 0;">&nbsp;&nbsp;&nbsp;<div class="adhead_custom_brand" style=""><b>eNikMa</b> Unified Comm</div>'}}common.ShowNotifications2(),e(),common.IsIeVersion(10)&&j$("#contactslist_list").children().css("line-height","normal"),common.IsIeVersion(10)&&j$("#contactslist_notification_list").children().css("line-height","normal"),j$("#contactslist_notification_list").height(common.GetDeviceHeight()-55),n(),common.ShowOfferSaveContact()}catch(r){common.PutToDebugLogException(2,"_contactslist: onStart",r)}}function e(){try{j$("#page_contactslist").css("min-height","auto");var t=common.GetDeviceWidth()-j$("#contactslist_additional_header_left").width()-j$("#contactslist_additional_header_right").width(),o=common.StrToIntPx(j$("#contactslist_additional_header_left").css("margin-left"));(common.isNull(o)||0===o)&&(o=10),o=Math.ceil(6*o),t=Math.floor(t-o)-20,j$("#contactslist_notification").width(t),j$("#contactslist_notification").height(Math.floor(j$("#contactslist_additional_header_left").height()));var e=common.GetDeviceHeight()-j$("#contactslist_header").height()-common.StrToIntPx(j$(".ui-input-search").css("border-top-width"))-common.StrToIntPx(j$(".ui-input-search").css("border-bottom-width"));e-=35;var n=common.StrToIntPx(j$(".ui-input-search").css("margin-top"));e=e-n-n,e-=3,j$("#footertext_contactslist").is(":visible")&&(e-=j$("#footertext_contactslist").height()),j$("#advert_contactslist").is(":visible")&&(e-=j$("#advert_contactslist").height()),j$("#togglecontact_container").is(":visible")&&(e-=j$("#togglecontact_container").height()),j$("#contactslist_list").height(e),global.bname_charcount>0&&common.GetBrandName().length>global.bname_charcount&&(j$("#app_name_contactslist").html(""),j$("#contactslist_additional_header_left").width("35%"));var i=j$("#contactslist_additional_header_left").width()-5;j$("#contactslist_presence").is(":visible")&&(i-=j$("#contactslist_presence").width()),j$("#app_name_contactslist").width(i)}catch(a){common.PutToDebugLogException(2,"_contactslist: MeasureContacslist",a)}}function n(){try{if(global.isdebugversion,common.isNull(global.ctlist)||global.ctlist.length<1){if(!0===common.IsMizuWebRTCEmbeddedServer()){var t=null;t=["Echo delayed",["5004","echod"],["phone","sip"],"0","0","0","0"],global.ctlist.push(t),t=["Echo",["5005","echo"],["phone","sip"],"0","0","0","0"],global.ctlist.push(t),t=["Funny",["5003","funny"],["phone","sip"],"0","0","0","0"],global.ctlist.push(t),t=["Music",["5002","music"],["phone","sip"],"0","0","0","0"],global.ctlist.push(t),t=["Playback",["5011","playback"],["phone","sip"],"0","0","0","0"],global.ctlist.push(t),t=["Record",["5010","record"],["phone","sip"],"0","0","0","0"],global.ctlist.push(t),t=["Redial",["5901","redial"],["phone","sip"],"0","0","0","0"],global.ctlist.push(t),t=["Voicemail",["5001","voicemail"],["phone","sip"],"0","0","0","0"],global.ctlist.push(t)}else t=["Voicemail",[],[],"0","0","0","0"],global.ctlist.push(t);i(),common.GetContacts(function(t){t||common.PutToDebugLog(2,"ERROR, _contactslist: LoadContacts failed"),a(!1)})}else a(!1)}catch(o){common.PutToDebugLogException(2,"_contactslist: LoadContacts",o)}}function i(){try{var t=null,o=common.GetConfig("defcontacts");if(common.isNull(webphone_api.parameters.defcontacts)||(o=webphone_api.parameters.defcontacts),!common.isNull(o)&&o.length>2){var e=o.split(";");if(!common.isNull(e))for(var n=0;n<e.length;n++)if(!(common.isNull(e[n])||e[n].length<3||e[n].indexOf(",")<1)){var i=common.Trim(e[n].substring(0,e[n].indexOf(","))),a=common.Trim(e[n].substring(e[n].indexOf(",")+1));common.isNull(a)&&(a=""),a=common.ReplaceAll(a,",",""),a=common.Trim(a);var c="sip";common.IsNumber(a)&&(c="phone"),t=[i,[a],[c],"0","0","0","0"],global.ctlist.push(t)}}}catch(l){common.PutToDebugLogException(2,"_contactslist: AddDefContacts",l)}}function a(t){try{if(common.isNull(document.getElementById("contactslist_list")))return void common.PutToDebugLog(2,"ERROR, _contactslist: PopulateList listelement is null");if(common.isNull(global.ctlist)||global.ctlist.length<1){var o='<span style="text-shadow:0 0 0;">'+stringres.get("no_contacts_1")+"</span>";return 0===common.GetParameterInt("showsynccontactsmenu",0)&&(o=o+'<br /><br /><br /><span style="text-shadow:0 0 0;">'+stringres.get("no_contacts_2")+"</span>"),j$("#contactslist_list").html(o),j$("#sync_contacts").on("click",function(){common.DownloadContacts()}),void common.PutToDebugLog(2,"EVENT, _contactslist: PopulateList no contacts")}if(common.PutToDebugLog(2,"EVENT, _contactslist Starting populate list"),I=[],t){var e=common.GetParameter("servercontacts");if(common.isNull(e)||e.length<1)return;var n=e.split(","),i=0;if(common.isNull(n)||n.length<1)I=[];else for(var a=0;a<global.ctlist.length;a++){var c=global.ctlist[a];if(!(common.isNull(c)||c.length<1)){var l=c[common.CT_NUMBER],s=c[common.CT_PTYPE];if(!(common.isNull(l)||l.length<1)){for(var r=[],m=[],u=0,d=0;d<l.length;d++)n.indexOf(l[d])>=0&&(r[u]=l[d],m[u]=s[d],u++);r.length>0&&(c[common.CT_NUMBER]=r.slice(),c[common.CT_PTYPE]=m.slice(),I[i]=c.slice(),i++)}}}}else I=global.ctlist.slice();for(var g='<li id="contact_[ID]"><a data-transition="slide" class="mlistitem">[NAME]</a></li>',p="",a=0;a<I.length;a++){var c=I[a];if(!(common.isNull(c)||c.length<1)){var _=c[common.CT_NAME];if(common.isNull(_)||_.length<1){var h=c[common.CT_NUMBER];if(common.isNull(h)||h.length<1||common.isNull(h[0])||h[0].length<1)continue;_=h[0]}var f=g.replace("[ID]",a);f=f.replace("[NAME]",_),p+=f}}j$("#contactslist_list").html(""),j$("#contactslist_list").append(p).listview("refresh")}catch(b){common.PutToDebugLogException(2,"_contactslist: PopulateList",b)}}function c(t){try{if(common.isNull(t)||t.length<1)return void common.PutToDebugLog(2,"ERROR, _contactslist OnListItemClick id is NULL");var o="",e=t.indexOf("_");if(e<2)return void common.PutToDebugLog(2,"ERROR, _contactslist OnListItemClick invalid id");o=common.Trim(t.substring(e+1));if("voicemail"===I[o][common.CT_NAME].toLowerCase()){var n=I[o][common.CT_NUMBER];if(common.isNull(n)||n.length<1)return void common.SetVoiceMailNumber(function(t){if(!common.isNull(t)&&t.length>0){for(var e=0;e<global.ctlist.length;e++)if("Voicemail"===global.ctlist[e][common.CT_NAME]){global.ctlist.splice(e,1);break}var n=[];n[common.CT_NAME]=I[o][common.CT_NAME],n[common.CT_NUMBER]=[t],n[common.CT_PTYPE]=I[o][common.CT_PTYPE],n[common.CT_USAGE]=I[o][common.CT_USAGE],n[common.CT_LASTMODIF]=I[o][common.CT_LASTMODIF],n[common.CT_DELFLAG]=I[o][common.CT_DELFLAG],n[common.CT_FAV]=I[o][common.CT_FAV],n[common.CT_EMAIL]=I[o][common.CT_EMAIL],n[common.CT_ADDRESS]=I[o][common.CT_ADDRESS],n[common.CT_NOTES]=I[o][common.CT_NOTES],n[common.CT_WEBSITE]=I[o][common.CT_WEBSITE],n[common.CT_LASTACTIVE]=I[o][common.CT_LASTACTIVE],n[common.CT_ISFROMSYNC]="0",global.ctlist.push(n),global.wasCtModified=!0,a(!1)}})}global.intentctdetails[0]="ctid="+o,global.intentctdetails[1]="frompage=ctlist",j$.mobile.changePage("#page_contactdetails",{transition:"none",role:"page"})}catch(i){common.PutToDebugLogException(2,"_contactslist: OnListItemClick",i)}}function l(t){try{if(common.isNull(t)||t.length<1)return void common.PutToDebugLog(2,"ERROR, _contactslist OnListItemLongClick id is NULL");var o="",e=t.indexOf("_");if(e<2)return void common.PutToDebugLog(2,"ERROR, _contactslist OnListItemLongClick invalid id 1");if(o=common.Trim(t.substring(e+1)),common.isNull(o)||o.length<1||!common.IsNumber(o))return void common.PutToDebugLog(2,"ERROR, _contactslist OnListItemLongClick invalid id 2: "+o);for(var n="",i=I[o][common.CT_NAME],a=0;a<global.ctlist.length;a++)if(global.ctlist[a][common.CT_NAME]===i){n=a.toString();break}s(n)}catch(c){common.PutToDebugLogException(2,"_contactslist: OnListItemLongClick",c)}}function s(t,o){try{var e=I[t];(common.isNull(t)||t.length<1||!common.IsNumber(t))&&common.PutToDebugLog(2,"ERROR, _contactslist: CreateContextmenu invalid contact id: "+t);var n=common.GetDeviceWidth();n=!common.isNull(n)&&common.IsNumber(n)&&n>100?Math.floor(n/1.2):220;var i=common.ContactIsFavorite(t),a="",c='<li id="[ITEMID]"><a data-rel="back">[ITEMTITLE]</a></li>',l="";l=c.replace("[ITEMID]","#ct_item_edit_contact"),l=l.replace("[ITEMTITLE]",stringres.get("menu_editcontact")),a+=l,l="",l=c.replace("[ITEMID]","#ct_item_delete_contact"),l=l.replace("[ITEMTITLE]",stringres.get("menu_deletecontact")),a+=l,l="",l=c.replace("[ITEMID]","#ct_item_call"),l=l.replace("[ITEMTITLE]",stringres.get("menu_call")),a+=l,l="",!0===common.CanIUseVideo()&&(l=c.replace("[ITEMID]","#ct_item_video_call"),l=l.replace("[ITEMTITLE]",stringres.get("btn_videocall")),a+=l,l=""),l=c.replace("[ITEMID]","#ct_item_message"),l=l.replace("[ITEMTITLE]",stringres.get("send_msg")),a+=l,l="",!1===common.GetConfigBool("hasfiletransfer",!0)||!0!==common.GetConfigBool("usingmizuserver",!1)&&!0!==common.IsMizuWebRTCGateway()||!0===common.Glft()&&(l=c.replace("[ITEMID]","#ct_item_filetransf"),l=l.replace("[ITEMTITLE]",stringres.get("filetransf_title")),a+=l,l="");var s=stringres.get("menu_ct_setfavorite");!0===i&&(s=stringres.get("menu_ct_unsetfavorite")),l=c.replace("[ITEMID]","#ct_item_favorite"),l=l.replace("[ITEMTITLE]",s),a+=l,l="";var p='<div id="ct_contextmenu" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+n+"px; min-width: "+Math.floor(.6*n)+'px;"><div data-role="header" data-theme="b"><a href="javascript:;" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+e[common.CT_NAME]+'</h1></div><div role="main" class="ui-content adialog_content" style="padding: 0; margin: 0;"><ul id="ct_contextmenu_ul" data-role="listview" data-inset="true" data-icon="false" style="margin: 0;">'+a+'</ul></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" style="width: 98%;" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_close")+"</a></div></div>";o=o||function(){},j$.mobile.activePage.append(p).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(t){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),j$("#ct_contextmenu_ul").off("click","li"),o()}}),j$("#ct_contextmenu_ul").on("click","li",function(o){var e=j$(this).attr("id");j$("#ct_contextmenu").on("popupafterclose",function(o){j$("#ct_contextmenu").off("popupafterclose"),"#ct_item_edit_contact"===e?g(t):"#ct_item_delete_contact"===e?d(t):"#ct_item_call"===e?m(t,!1):"#ct_item_video_call"===e?m(t,!0):"#ct_item_message"===e?u(t):"#ct_item_filetransf"===e?r(t):"#ct_item_favorite"===e&&(!0===i?(common.ContactSetFavorite(t,!1),common.ShowToast(stringres.get("ct_unsetfavorited"),1400)):(common.ContactSetFavorite(t,!0),common.ShowToast(stringres.get("menu_ct_setfavorite"),1400)))})})}catch(_){common.PutToDebugLogException(2,"_contactslist: CreateContextmenu",_)}}function r(t){try{common.PutToDebugLog(2,"EVENT, _contactslist: FileTrasnf contact id: "+t);var o=common.StrToInt(t),e=global.ctlist[o],n=e[common.CT_NUMBER];return common.isNull(n)||n.length<1?(common.PutToDebugLog(1,"ERROR,"+stringres.get("ct_menu_error")),void common.ShowToast("ERROR,"+stringres.get("ct_menu_error"))):1===n.length?void common.FileTransfer(n[0]):void common.PickContactNumber(o,function(t,o){common.FileTransfer(t)})}catch(i){common.PutToDebugLogException(2,"_contactslist: FileTrasnf",i)}}function m(t,o){try{common.PutToDebugLog(2,"EVENT, _contactslist: InitiateCall contact id: "+t);var e=common.StrToInt(t),n=global.ctlist[e],i=n[common.CT_NUMBER];if(common.isNull(i)||i.length<1)return common.PutToDebugLog(1,"ERROR,"+stringres.get("ct_menu_error")),void common.ShowToast("ERROR,"+stringres.get("ct_menu_error"));if(1===i.length){var a=common.NormalizeNumber(i[0]);return void(!0===o?(common.PutToDebugLog(4,"EVENT, _contactslist initiate video call to: "+a),webphone_api.videocall(a)):(common.PutToDebugLog(4,"EVENT, _contactslist initiate call to: "+a),webphone_api.call(a,-1)))}return void common.PickContactNumber(e,function(t,e){var n=common.NormalizeNumber(t);!0===o?(common.PutToDebugLog(4,"EVENT, _contactslist initiate video call to: "+n),webphone_api.videocall(n)):(common.PutToDebugLog(4,"EVENT, _contactslist initiate call to: "+n),webphone_api.call(n,-1))})}catch(c){common.PutToDebugLogException(2,"_contactslist: InitiateCall",c)}}function u(t){try{common.PutToDebugLog(2,"EVENT, _contactslist: SendMessage contact id: "+t);var o=common.StrToInt(t),e=global.ctlist[o],n=e[common.CT_NUMBER];return common.isNull(n)||n.length<1?(common.PutToDebugLog(1,"ERROR,"+stringres.get("ct_menu_error")),void common.ShowToast("ERROR,"+stringres.get("ct_menu_error"))):1===n.length?void common.StartMsg(n[0],"","_contactslist"):void common.PickContactNumber(o,function(t,o){common.StartMsg(t,"","_contactslist")})}catch(i){common.PutToDebugLogException(2,"_contactslist: SendMessage",i)}}function d(t,o){try{var e=common.GetDeviceWidth();e=!common.isNull(e)&&common.IsNumber(e)&&e>100?Math.floor(e/1.2):220;var n='<div id="ct_delete_contact_popup" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+e+'px;"><div data-role="header" data-theme="b"><a href="javascript:;" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+stringres.get("menu_deletecontact")+'</h1></div><div role="main" class="ui-content adialog_content adialog_alert"><span> '+stringres.get("contact_delete_msg")+' </span></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" id="btn_adialog_ok" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_ok")+'</a><a href="javascript:;" id="adialog_negative" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back">'+stringres.get("btn_cancel")+"</a></div></div>";o=o||function(){},j$.mobile.activePage.append(n).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(t){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").bind({popupbeforeposition:function(){j$(this).unbind("popupbeforeposition");var t=Math.floor(.6*common.GetDeviceHeight());j$(this).height()>t&&j$(".messagePopup .ui-content").height(t)}}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),j$("#btn_adialog_ok").off("click"),o()}}),j$("#btn_adialog_ok").on("click",function(){global.ctlist.splice(t,1),common.SaveContactsFile(function(t){common.PutToDebugLog(4,"EVENT, _contactslist: DeleteContact SaveContactsFile: "+t.toString())}),a(!1)})}catch(i){common.PutToDebugLogException(2,"_contactdetails: DeleteContact",i)}}function g(t){try{global.intentaddeditct[0]="action=edit",global.intentaddeditct[1]="ctid="+t,j$.mobile.changePage("#page_addeditcontact",{transition:"pop",role:"page"})}catch(o){common.PutToDebugLogException(2,"_contactslist: EditContact",o)}}function p(t){try{if(common.IsWindowsSoftphone()&&j$("#btn_contactslist_menu").removeAttr("data-transition"),common.isNull(t)||t.lenght<1)return void common.PutToDebugLog(2,"ERROR, _contactslist: CreateOptionsMenu menuid null");if(j$(t).length<=0)return void common.PutToDebugLog(2,"ERROR, _contactslist: CreateOptionsMenu can't get reference to Menu");"#"!==t.charAt(0)&&(t="#"+t),j$(t).html("");var o=common.GetParameterInt("featureset",3);j$(t).append('<li id="'+C+'"><a data-rel="back">'+stringres.get("menu_new_contact")+"</a></li>").listview("refresh"),!0===common.IsWindowsSoftphone()?o>1&&j$(t).append('<li id="'+w+'"><a data-rel="back">'+stringres.get("menu_import_list")+"...</a></li>").listview("refresh"):o>1&&(0===common.GetParameterInt("showsynccontactsmenu",0)||1===common.GetParameterInt("showsynccontactsmenu",0))&&j$(t).append('<li id="'+w+'"><a data-rel="back">'+stringres.get("menu_sync")+"</a></li>").listview("refresh"),o>1&&(0===common.GetParameterInt("showsynccontactsmenu",0)||1===common.GetParameterInt("showsynccontactsmenu",0))&&j$(t).append('<li id="'+k+'"><a data-rel="back">'+stringres.get("menu_sortct")+"</a></li>").listview("refresh"),!1===common.GetConfigBool("hasfiletransfer",!0)||!0!==common.GetConfigBool("usingmizuserver",!1)&&!0!==common.IsMizuWebRTCGateway()||!0===common.Glft()&&j$(t).append('<li id="'+D+'"><a data-rel="back">'+stringres.get("filetransf_title")+"</a></li>").listview("refresh"),j$(t).append('<li id="'+y+'"><a data-rel="back">'+stringres.get("menu_delallct")+"</a></li>").listview("refresh"),j$(t).append('<li id="'+$+'"><a data-rel="back">'+stringres.get("settings_title")+"</a></li>").listview("refresh");var e=stringres.get("menu_help")+"...";60===common.GetConfigInt("brandid",-1)&&(e=stringres.get("help_about")),j$(t).append('<li id="'+N+'"><a data-rel="back">'+e+"</a></li>").listview("refresh");var n=common.GetParameter("linktext"),i=common.GetParameter("linkurl"),a=common.GetParameter("linktext2"),c=common.GetParameter("linkurl2"),l=common.GetParameter("linktext3"),s=common.GetParameter("linkurl3");return!common.isNull(n)&&n.length>0&&!common.isNull(i)&&i.length>0&&j$(t).append('<li id="'+S+'"><a data-rel="back">'+n+"</a></li>").listview("refresh"),!common.isNull(a)&&a.length>0&&!common.isNull(c)&&c.length>0&&j$(t).append('<li id="'+x+'"><a data-rel="back">'+a+"</a></li>").listview("refresh"),!common.isNull(l)&&l.length>0&&!common.isNull(s)&&s.length>0&&j$(t).append('<li id="'+R+'"><a data-rel="back">'+l+"</a></li>").listview("refresh"),common.IsWindowsSoftphone()&&j$(t).append('<li id="'+L+'"><a data-rel="back">'+stringres.get("menu_exit")+"</a></li>").listview("refresh"),!0}catch(r){common.PutToDebugLogException(2,"_contactslist: CreateOptionsMenu",r)}return!1}function _(t){try{if(common.isNull(t)||t.length<1)return;j$("#contactslist_menu").on("popupafterclose",function(o){switch(j$("#contactslist_menu").off("popupafterclose"),t){case C:E();break;case $:common.OpenSettings(!0,11);break;case D:common.FileTransfer("");break;case y:h();break;case N:setTimeout(function(){common.HelpWindow("settings")},300);break;case L:common.Exit();break;case w:!0===common.IsWindowsSoftphone()?v():common.DownloadContacts();break;case k:b();break;case M:f();break;case S:common.OpenWebURL(common.GetParameter("linkurl"),common.GetParameter("linktext"));break;case x:common.OpenWebURL(common.GetParameter("linkurl2"),common.GetParameter("linktext2"));break;case R:common.OpenWebURL(common.GetParameter("linkurl3"),common.GetParameter("linktext3"))}})}catch(o){common.PutToDebugLogException(2,"_contactslist: MenuItemSelected",o)}}function h(t){try{var o=common.GetDeviceWidth();o=!common.isNull(o)&&common.IsNumber(o)&&o>100?Math.floor(o/1.2):220;var e='<div id="delete_allcontacts_popup" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+o+'px;"><div data-role="header" data-theme="b"><a href="javascript:;" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+stringres.get("menu_deletecontact")+'</h1></div><div role="main" class="ui-content adialog_content adialog_alert"><span> '+stringres.get("contact_delete_all_msg")+' </span></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" id="btn_adialog_ok" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_ok")+'</a><a href="javascript:;" id="adialog_negative" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back">'+stringres.get("btn_cancel")+"</a></div></div>";t=t||function(){},j$.mobile.activePage.append(e).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(t){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").bind({popupbeforeposition:function(){j$(this).unbind("popupbeforeposition");var t=Math.floor(.6*common.GetDeviceHeight());j$(this).height()>t&&j$(".messagePopup .ui-content").height(t)}}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),j$("#btn_adialog_ok").off("click"),t()}}),j$("#btn_adialog_ok").on("click",function(){common.PutToDebugLog(2,"EVENT, _contactslist: DeleteAllContacts OK clicked"),global.ctlist=null,global.ctlist=[],common.SaveContactsFile(function(t){common.PutToDebugLog(4,"EVENT, _contactslist: DeleteAllContacts SaveContactsFile: "+t.toString())}),a(!1)})}catch(n){common.PutToDebugLogException(2,"_contactslist: DeleteAllContacts",n)}}function f(t){try{var o=common.GetDeviceWidth();o=!common.isNull(o)&&common.IsNumber(o)&&o>100?Math.floor(o/1.2):220;var e="",n='<li id="[ITEMID]"><a data-rel="back">[ITEMTITLE]</a></li>',i="";i=n.replace("[ITEMID]","#item_filter_all"),i=i.replace("[ITEMTITLE]",stringres.get("ct_filter_all")),e+=i,i="",i=n.replace("[ITEMID]","#item_filter_important"),i=i.replace("[ITEMTITLE]",stringres.get("ct_filter_important")),e+=i,i="",i=n.replace("[ITEMID]","#item_filter_online"),i=i.replace("[ITEMTITLE]",stringres.get("ct_filter_online")),e+=i,i="";var c='<div id="filterct_popup" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+o+"px; min-width: "+Math.floor(.6*o)+'px;"><div data-role="header" data-theme="b"><a href="javascript:;" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+stringres.get("ct_filter_title")+'</h1></div><div role="main" class="ui-content adialog_content" style="padding: 0; margin: 0;"><ul id="filterct_ul" data-role="listview" data-inset="true" data-icon="false" style="margin: 0;">'+e+'</ul></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" style="width: 98%;" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_close")+"</a></div></div>";t=t||function(){},j$.mobile.activePage.append(c).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(t){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),j$("#filterct_ul").off("click","li"),t()}}),j$("#filterct_ul").on("click","li",function(t){var o=j$(this).attr("id");"#item_filter_all"===o?(common.SaveParameter("lastfilterval",common.GetParameter("filtercontacts")),common.SaveParameter("filtercontacts","0"),a(!1)):"#item_filter_important"===o?(common.SaveParameter("lastfilterval",common.GetParameter("filtercontacts")),common.SaveParameter("filtercontacts","1"),a(!1)):"#item_filter_online"===o&&(common.SaveParameter("lastfilterval",common.GetParameter("filtercontacts")),common.SaveParameter("filtercontacts","2"),a(!1))})}catch(l){common.PutToDebugLogException(2,"_contactslist: FilterContactsByPopup",l)}}function b(t){try{var o=common.GetDeviceWidth();o=!common.isNull(o)&&common.IsNumber(o)&&o>100?Math.floor(o/1.2):220;var e="",n='<li id="[ITEMID]"><a data-rel="back">[ITEMTITLE]</a></li>',i="";i=n.replace("[ITEMID]","#item_sort_name"),i=i.replace("[ITEMTITLE]",stringres.get("ct_sort_name")),e+=i,i="",i=n.replace("[ITEMID]","#item_sort_importance"),i=i.replace("[ITEMTITLE]",stringres.get("ct_sort_importance")),e+=i,i="",i=n.replace("[ITEMID]","#item_sort_status"),i=i.replace("[ITEMTITLE]",stringres.get("ct_sort_status")),e+=i,i="";var c='<div id="sortct_popup" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+o+"px; min-width: "+Math.floor(.6*o)+'px;"><div data-role="header" data-theme="b"><a href="javascript:;" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+stringres.get("ct_sort_title")+'</h1></div><div role="main" class="ui-content adialog_content" style="padding: 0; margin: 0;"><ul id="sortct_ul" data-role="listview" data-inset="true" data-icon="false" style="margin: 0;">'+e+'</ul></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" style="width: 98%;" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_close")+"</a></div></div>";t=t||function(){},j$.mobile.activePage.append(c).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(t){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),j$("#sortct_ul").off("click","li"),t()}}),j$("#sortct_ul").on("click","li",function(t){var o=j$(this).attr("id");"#item_sort_name"===o?(common.SaveParameter("sortcontacts","0"),common.SortContacts(),a(!1)):"#item_sort_importance"===o?(common.SaveParameter("sortcontacts","1"),common.SortContacts(),a(!1)):"#item_sort_status"===o&&(common.SaveParameter("sortcontacts","2"),common.SortContacts(),a(!1))})}catch(l){common.PutToDebugLogException(2,"_contactslist: SortContactsPopup",l)}}function v(t){try{var o=common.GetDeviceWidth();o=!common.isNull(o)&&common.IsNumber(o)&&o>100?Math.floor(o/1.2):220;var e="",n='<li id="[ITEMID]"><a data-rel="back">[ITEMTITLE]</a></li>',i="";i=n.replace("[ITEMID]","#item_import_file"),i=i.replace("[ITEMTITLE]",stringres.get("menu_import_file")),e+=i,i="",i=n.replace("[ITEMID]","#item_import_outlook"),i=i.replace("[ITEMTITLE]",stringres.get("menu_import_outlook")),e+=i,i="",i=n.replace("[ITEMID]","#item_import_skype"),i=i.replace("[ITEMTITLE]",stringres.get("menu_import_skype")),e+=i,i="",i=n.replace("[ITEMID]","#item_import_google"),i=i.replace("[ITEMTITLE]",stringres.get("menu_import_google")),e+=i,i="",i=n.replace("[ITEMID]","#item_import_android"),i=i.replace("[ITEMTITLE]",stringres.get("menu_import_android")),e+=i,i="",i=n.replace("[ITEMID]","#item_export_file"),i=i.replace("[ITEMTITLE]",stringres.get("menu_export_file")),e+=i,i=""
;var a='<div id="import_contacts_window" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+o+"px; min-width: "+Math.floor(.6*o)+'px;"><div data-role="header" data-theme="b"><a href="javascript:;" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+stringres.get("menu_import_list")+'</h1></div><div role="main" class="ui-content adialog_content" style="padding: 0; margin: 0;"><ul id="import_contacts_window_ul" data-role="listview" data-inset="true" data-icon="false" style="margin: 0;">'+e+'</ul></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" style="width: 98%;" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_close")+"</a></div></div>";t=t||function(){},j$.mobile.activePage.append(a).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(t){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),j$("#import_contacts_window_ul").off("click","li"),t()}}),j$("#import_contacts_window_ul").on("click","li",function(t){var o=j$(this).attr("id");j$("#import_contacts_window").on("popupafterclose",function(t){j$("#import_contacts_window").off("popupafterclose"),T(o)})})}catch(c){common.PutToDebugLogException(2,"_contactslist: ImportContactsPopup",c)}}function T(t){try{if(common.isNull(t)||t.length<3)return void common.PutToDebugLog(2,"ERROR, _contactslist ImportContacts invalid entry: "+t);if(common.PutToDebugLog(2,"EVENT, USER ImportContacts: "+t),"#item_import_android"===t)common.DownloadContacts();else if("#item_import_file"===t){var o=common.AddJscommport(global.WIN_SOFTPHONE_URL)+"?extcmd_import_file";common.WinSoftphoneHttpReq(o,"GET","",function(t){common.PutToDebugLog(2,"EVENT, Import contacts from file: "+t)})}else if("#item_export_file"===t){var o=common.AddJscommport(global.WIN_SOFTPHONE_URL)+"?extcmd_export_file";common.WinSoftphoneHttpReq(o,"GET","",function(t){common.PutToDebugLog(2,"EVENT, Export contacts to file: "+t)})}else if("#item_import_outlook"===t){var o=common.AddJscommport(global.WIN_SOFTPHONE_URL)+"?extcmd_import_outlook";common.WinSoftphoneHttpReq(o,"GET","",function(t){common.PutToDebugLog(2,"EVENT, Import contacts from outlook: "+t)})}else if("#item_import_skype"===t){var o=common.AddJscommport(global.WIN_SOFTPHONE_URL)+"?extcmd_import_skype";common.WinSoftphoneHttpReq(o,"GET","",function(t){common.PutToDebugLog(2,"EVENT, Import contacts from skype: "+t)})}else if("#item_import_skype"===t){var o=common.AddJscommport(global.WIN_SOFTPHONE_URL)+"?extcmd_import_google";common.WinSoftphoneHttpReq(o,"GET","",function(t){common.PutToDebugLog(2,"EVENT, Import contacts from google: "+t)})}}catch(e){common.PutToDebugLogException(2,"_contactslist: ImportContacts",e)}}function E(){try{global.intentaddeditct=[],global.intentaddeditct[0]="action=add",j$.mobile.changePage("#page_addeditcontact",{transition:"pop",role:"page"})}catch(t){common.PutToDebugLogException(2,"_contactslist: NewContact",t)}}function P(t){try{common.PutToDebugLog(4,"EVENT, _contactslist: onStop"),global.isContactslistStarted=!1,j$("select#togglecontact").val("no").flipswitch("refresh"),common.SaveContactsFile(function(t){common.PutToDebugLog(4,"EVENT, _contactslist: onDestroy SaveContactsFile: "+t.toString())})}catch(o){common.PutToDebugLogException(2,"_contactslist: onStop",o)}}function j(t){}var I=[],$="#menuitem_contactslist_settings",N="#menuitem_contactslist_help",C="#menuitem_contactslist_newcontact",L="#menuitem_contactslist_exit",w="#menuitem_contactslist_sync",D="#menuitem_contactslist_filetransfer",k="#menuitem_contactslist_sortcontacts",M="#menuitem_contactslist_filtercontacts",y="#menuitem_contactslist_deleteallct",S="menuitem_contactslist_custom_link",x="menuitem_contactslist_custom_link2",R="menuitem_contactslist_custom_link3",G={PopulateList:a,MeasureContacslist:e};return window.contactslist_public=G,{onCreate:t,onStart:o,onStop:P,onDestroy:j}}();