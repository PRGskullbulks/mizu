wpa._filters=function(){function t(t){try{common.PutToDebugLog(4,"EVENT, _filters: onCreate"),j$("#filters_list").on("click",".ch_anchor",function(t){n(j$(this).attr("id"))}),j$("#filters_list").on("click",".ch_menu",function(t){n(j$(this).attr("id"))}),j$(window).resize(function(){"page_filters"===j$.mobile.activePage.attr("id")&&i()}),j$("#filters_menu_ul").on("click","li",function(t){s(j$(this).attr("id"))}),j$("#btn_filters_menu").on("click",function(){c("#filters_menu_ul")}),j$("#btn_filters_menu").attr("title",stringres.get("hint_menu")),j$("#btn_add_filters").on("click",function(){l(!1,null)})}catch(e){common.PutToDebugLogException(2,"_filters: onCreate",e)}}function e(t){try{common.PutToDebugLog(4,"EVENT, _filters: onStart"),global.isFiltersStarted=!0,common.isNull(document.getElementById("filters_title"))||(document.getElementById("filters_title").innerHTML=stringres.get("filters_title")),j$("#filters_title").attr("title",stringres.get("hint_page")),j$("#filters_label_add").html(stringres.get("filters_add_label")),j$(".separator_line_thick").css("background-color",common.HoverCalc(common.getBgColor("#page_filters"),-30)),common.isNull(document.getElementById("filters_btnback"))||(document.getElementById("filters_btnback").innerHTML="<b>&LT;</b>&nbsp;"+stringres.get("go_back_btn_txt")),i(),common.IsIeVersion(10)&&j$("#filters_list").children().css("line-height","normal"),o()}catch(e){common.PutToDebugLogException(2,"_filters: onStart",e)}}function i(){try{j$("#page_filters").css("min-height","auto");var t=common.GetDeviceHeight()-j$("#filters_header").height()-j$("#filters_add_section").height();t=t-(common.StrToIntPx(j$("#filters_add_section").css("margin-top"))+common.StrToIntPx(j$("#filters_add_section").css("margin-bottom")))-3,j$("#filters_list").height(t)}catch(e){common.PutToDebugLogException(2,"_filters: MeasureFilterslist",e)}}function o(){try{if(common.isNull(document.getElementById("filters_list")))return void common.PutToDebugLog(2,"ERROR, _filters: PopulateList listelement is null");a();var t="";if(common.isNull(g)||g.length<1)return j$("#filters_list").html(""),j$("#filters_list").append(t).listview("refresh"),void common.PutToDebugLog(2,"EVENT, _filters: PopulateList no filters to display");for(var e='<li data-theme="b"><a id="filteritem_[FID]" class="ch_anchor mlistitem" title="'+stringres.get("filter_edit_hint")+'"><div class="item_container"><div class="r_what">'+stringres.get("filter_start")+': <span>[WHAT]</span></div><div class="r_with">'+stringres.get("filter_replace")+': <span>[WITH]</span></div><div class="r_minlen">'+stringres.get("filter_minlen")+': <span>[MINL]</span></div><div class="r_maxlen">'+stringres.get("filter_maxlen")+': <span>[MAXL]</span></div></div></a><a id="filtermenu_[FID]" class="ch_menu mlistitem">'+stringres.get("filter_delete_hint")+"</a></li>",i=0;i<g.length;i++){var o=g[i];common.isNull(o[common.F_WHAT])&&(o[common.F_WHAT]=""),common.isNull(o[common.F_WITH])&&(o[common.F_WITH]=""),common.isNull(o[common.F_MIN])&&(o[common.F_MIN]=""),common.isNull(o[common.F_MAX])&&(o[common.F_MAX]="");var n=common.ReplaceAll(e,"[FID]",i.toString());n=n.replace("[WHAT]",o[common.F_WHAT]),n=n.replace("[WITH]",o[common.F_WITH]),n=n.replace("[MINL]",o[common.F_MIN]),n=n.replace("[MAXL]",o[common.F_MAX]),t+=n}j$("#filters_list").html(""),j$("#filters_list").append(t).listview("refresh")}catch(l){common.PutToDebugLogException(2,"_filters: PopulateList",l)}}function n(t){try{if(_)return;if(_=!0,setTimeout(function(){_=!1},1e3),common.isNull(t)||t.length<1)return void common.PutToDebugLog(2,"ERROR, _filters OnListItemClick id is NULL");var e="",i=t.indexOf("_");if(i<2)return void common.PutToDebugLog(2,"ERROR, _filters OnListItemClick invalid id");e=common.Trim(t.substring(i+1));var o=0;try{o=common.StrToInt(common.Trim(e))}catch(n){common.PutToDebugLogException(2,"_filters: OnListItemClick convert fid",n)}0===t.indexOf("filteritem")?l(!0,o):0===t.indexOf("filtermen")&&r(o)}catch(a){common.PutToDebugLogException(2,"_filters: OnListItemClick",a)}}function l(t,e,i){try{var n=common.GetDeviceWidth();n=!common.isNull(n)&&common.IsNumber(n)&&n>100?Math.floor(n/1.2):220;var l="",r="",a="",c="";if(!0===t&&!common.isNull(e)&&common.IsNumber(e)){var s=g[e];l=s[common.F_WHAT],r=s[common.F_WITH],a=s[common.F_MIN],c=s[common.F_MAX],common.isNull(l)&&(l=""),common.isNull(r)&&(r=""),common.isNull(a)&&(a=""),common.isNull(c)&&(c="")}var u='<div id="filter_popup" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="width:'+n+"px; max-width:"+n+"px; min-width: "+Math.floor(.6*n)+'px;"><div data-role="header" data-theme="b"><a href="javascript:;" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+stringres.get("filters_add_rule")+'</h1></div><div role="main" class="ui-content adialog_content" style="padding: 0; margin: 0; width: 100%;"><div class="filter_left_container"><label style="width: 100%">'+stringres.get("filter_start")+':</label></div><div class="filter_right_container"><input name="filter_what" id="filter_what" data-highlight="true" data-mini="true" value="'+l+'" type="text" autocapitalize="off"></div><div class="filter_left_container"><label style="width: 100%">'+stringres.get("filter_replace")+':</label></div><div class="filter_right_container"><input name="filter_with" id="filter_with" data-highlight="true" data-mini="true" value="'+r+'" type="text" autocapitalize="off"></div><div class="filter_left_container"><label style="width: 100%">'+stringres.get("filter_minlen")+':</label></div><div class="filter_right_container"><input name="filter_min" id="filter_min" data-highlight="true" data-mini="true" value="'+a+'" type="text" autocapitalize="off"></div><div class="filter_left_container"><label style="width: 100%">'+stringres.get("filter_maxlen")+':</label></div><div class="filter_right_container"><input name="filter_max" id="filter_max" data-highlight="true" data-mini="true" value="'+c+'" type="text" autocapitalize="off"></div></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" id="adialog_positive" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_ok")+'</a><a href="javascript:;" id="adialog_negative" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back">'+stringres.get("btn_cancel")+"</a></div></div>";i=i||function(){},j$.mobile.activePage.append(u).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(t){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),i()}}),j$("#adialog_positive").on("click",function(i){common.PutToDebugLog(5,"EVENT, _filters AddFilter ok on click");var n=j$("#filter_what").val(),l=j$("#filter_with").val(),r=j$("#filter_min").val(),a=j$("#filter_max").val();if(common.isNull(n)&&(n=""),common.isNull(l)&&(l=""),common.isNull(r)&&(r=""),common.isNull(a)&&(a=""),n=common.Trim(n),l=common.Trim(l),r=common.Trim(r),a=common.Trim(a),n=common.ReplaceAll(n,",","_"),n=common.ReplaceAll(n,";","_"),l=common.ReplaceAll(l,",","_"),l=common.ReplaceAll(l,";","_"),common.IsNumber(r)||(r=""),common.IsNumber(a)||(a=""),n.length<1&&l.length<1)return void common.ShowToast(stringres.get("filter_warning"));var c=[];c[common.F_WHAT]=n,c[common.F_WITH]=l,c[common.F_MIN]=r,c[common.F_MAX]=a,!0===t&&!common.isNull(e)&&common.IsNumber(e)?g[e]=c:g.push(c),m(),o()})}catch(f){common.PutToDebugLogException(2,"_filters: AddFilter",f)}}function r(t){try{if(common.isNull(t)||!common.IsNumber(t)||t<0||t>=g.length)return void common.PutToDebugLog(2,"ERROR, _filters: DeleteFilter invalid id: "+t);g.splice(t,1),m(),o()}catch(e){common.PutToDebugLogException(2,"_filters: DeleteFilter",e)}}function a(){try{var t=common.GetParameter2("filters");if(g=[],common.isNull(t)||t.length<1)return void common.PutToDebugLog(3,"ReadFilters, nothing to read");var e=t.split(";");if(common.isNull(e)||e.length<1)return;for(var i=0;i<e.length;i++)if(!(common.isNull(e[i])||e[i].length<3)){var o=e[i].split(",");common.isNull(o)||4!==o.length||g.push(o)}}catch(n){common.PutToDebugLogException(2,"_filters: ReadFilters",n)}}function m(){try{if(common.isNull(g))return void common.PutToDebugLog(3,"SaveFilters, nothing to save");for(var t="",e=0;e<g.length;e++){var i=g[e];common.isNull(i)||i.length<3||(t.length>0&&(t+=";"),t=t+i[common.F_WHAT]+","+i[common.F_WITH]+","+i[common.F_MIN]+","+i[common.F_MAX])}common.isNull(t)&&(t=""),common.SaveParameter("filters",t)}catch(o){common.PutToDebugLogException(2,"_filters: SaveFilters",o)}}function c(t){try{return common.IsWindowsSoftphone()&&j$("#btn_filters_menu").removeAttr("data-transition"),common.isNull(t)||t.lenght<1?void common.PutToDebugLog(2,"ERROR, _filters: CreateOptionsMenu menuid null"):j$(t).length<=0?void common.PutToDebugLog(2,"ERROR, _filters: CreateOptionsMenu can't get reference to Menu"):("#"!==t.charAt(0)&&(t="#"+t),j$(t).html(""),j$(t).append('<li id="'+d+'"><a data-rel="back">'+stringres.get("menu_close")+"</a></li>").listview("refresh"),!0)}catch(e){common.PutToDebugLogException(2,"_filters: CreateOptionsMenu",e)}return!1}function s(t){try{if(common.isNull(t)||t.length<1)return;j$("#filters_menu").on("popupafterclose",function(e){switch(j$("#filters_menu").off("popupafterclose"),t){case d:j$.mobile.back()}})}catch(e){common.PutToDebugLogException(2,"_filters: MenuItemSelected",e)}}function u(t){try{common.PutToDebugLog(4,"EVENT, _filters: onStop"),global.isFiltersStarted=!1}catch(e){common.PutToDebugLogException(2,"_filters: onStop",e)}}function f(t){}var g=null,_=!1,d="#menuitem_filters_close";return{onCreate:t,onStart:e,onStop:u,onDestroy:f}}();