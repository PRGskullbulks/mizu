wpa._settings=function(){function e(e){try{common.PutToDebugLog(4,"EVENT, _settings: onCreate"),common.SetLanguage(),j$("#page_settings").keydown(function(e){if(13===e.which){e.preventDefault();var t=j$.mobile.activePage.find(".messagePopup");!common.isNull(t)&&t.length>0?j$("#adialog_positive").click():null!==document.getElementById("btn_login")?j$("#btn_login").click():null!==document.getElementById("lp_btn_login")&&j$("#lp_btn_login").click()}else{if(27!==e.which)return;e.preventDefault();var t=j$.mobile.activePage.find(".messagePopup");!common.isNull(t)&&t.length>0?j$("#adialog_negative").click():j$("#btn_back_settings").click()}});try{window.onerror=function(e,t,o,n,i){try{if(console){var a="GlobalErrorHandler: ERROR, "+e+" ("+i+") url: "+t+" line: "+o+" col: "+n;console.error?console.error(a):console.log&&console.log(a),common.PutToDebugLog(2,"ERROR, GlobalErrorHandler: "+a)}}catch(s){}return!1}}catch(o){}if(j$("#settings_list").on("click","li",function(e){g(j$(this).attr("id"))}),j$(window).resize(function(){"page_settings"===j$.mobile.activePage.attr("id")&&n()}),j$("#settings_menu_ul").on("click","li",function(e){y(j$(this).attr("id"))}),common.SetLogFormAction(),j$("#btn_settings_menu").on("click",function(){j("#settings_menu_ul")}),j$("#btn_settings_menu").attr("title",stringres.get("hint_menu")),j$("#btn_back_settings").attr("title",stringres.get("hint_btnback")),j$("#lp_btn_login").attr("title",stringres.get("hint_settlogin")),j$("#btn_back_settings").on("click",function(e){f(e)}),j$("#btn_settings_engine_close").on("click",function(e){common.SaveParameter("ignoreengineselect","true"),j$("#settings_engine").hide(),j$("#dialpad_engine").hide(),n()}),j$("#a_newuser").on("click",function(e){S(),e.preventDefault()}),j$("#a_forgotpassword").on("click",function(e){if(common.IsWindowsSoftphone()){var t=common.GetConfig("forgotpasswordurl");!common.isNull(t)&&t.length>3&&(common_public.OpenLinkInExternalBrowser(t),e.preventDefault())}}),j$("#lp_btn_custom").on("click",function(e){T()}),j$("#btn_settings_engine").on("click",function(e){if(common.SaveParameter("ignoreengineselect","true"),j$("#settings_engine").hide(),j$("#dialpad_engine").hide(),!(common.isNull(H)||H.length<1)){if(n(),"java"===H);else if("webrtc"===H)common.EngineSelect(1);else if("ns"===H){setTimeout(function(){common.NPDownloadAndInstall()},400);var t=common.GetNPLocation();!isNull(t)&&t.length>0&&window.open(t)}else if("flash"===H);else if("app"===H){common.ResetEngineClicked();var o=GetEngine("app");o.clicked=2,SetEngine("app",o)}var o=common.GetEngine(H);common.isNull(o)||(o.clicked=2,common.SetEngine(H,o),common.ShowToast(common.GetEngineDisplayName(H)+" "+stringres.get("ce_use"),function(){common.ChooseEngineLogic2(H),H=""}))}}),58===common.GetConfigInt("brandid",-1)){var t=document.getElementById("logologinpage");common.isNull(t)||(t.innerHTML='<img src="'+common.GetElementSource()+'images/logo.png" style="border: 0;">&nbsp;&nbsp;<div style="color:#000; font-size: .6em; display: inline-block; position: relative; top: -0.6em;"><b>eNikMa</b> Unified Comm</div>')}}catch(i){common.PutToDebugLogException(2,"_settings: onCreate",i)}}function t(e){try{if(common.SetCurrTheme(),global.isdebugengine&&setTimeout(function(){common_public.ChooseEngineLogic(function(){alert("StartUp")},!1)},200),ge=!1,global.pagewasrefreshed=!1,global.dploadingdisplayed=!1,common.PutToDebugLog(4,"EVENT, _settings: onStart"),document.getElementById("phone_app_main_container").style.display="block",common.ShowModalLoader(stringres.get("loading")),common.PutToDebugLogSpecial(1,"EVENT, _settings: onStart display Loading... modal loader_1",!1,""),global.apppletloaded=!1,common.IsWindowsSoftphone()&&common.WinAPI("API_GuiStarted",function(e){common.PutToDebugLog(2,"EVENT, _settings API_GuiStarted response: "+e)}),global.isSettingsStarted=!0,j$("#settings_list").prev("form.ui-filterable").hide(),common.isNull(document.getElementById("settings_page_title"))||(document.getElementById("settings_page_title").innerHTML=stringres.get("settings_title")),j$("#settings_page_title").attr("title",stringres.get("hint_page")),j$(".separator_line_thick").css("background-color",common.HoverCalc(common.getBgColor("#settings_header"),-30)),common.IsIeVersion(10)&&j$("#settings_list").children().css("line-height","normal"),j$("#settings_page_title").html(stringres.get("settings_login")),U=common.GetIntentParam(global.intentsettings,"startedfrom"),common.isNull(U)&&(U=""),"app"===U?(j$("#app_name_settings").hide(),j$("#btn_back_settings").show(),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("btn_cancel"))):(j$("#btn_back_settings").hide(),j$("#app_name_settings").show()),b()){j$("#settings_list").hide(),j$("#loginpage_container").show(),ue<2&&j$("#btn_settings_menu").hide(),common.IsWindowsSoftphone()||!0!==global.usestorage||j$("#settings_copyright").show();var t=common.GetConfig("newuser");50===common.GetConfigInt("brandid",-1)?(j$("#a_newuser").hide(),j$("#lp_btn_custom").html(stringres.get("favafone_new")),j$("#lp_btn_custom").show()):!common.isNull(t)&&t.length>3?(j$("#a_newuser").show(),j$("#a_newuser").html(stringres.get("newuser_a")),j$("#a_newuser").attr("href",t)):j$("#a_newuser").hide();var a=common.GetConfig("forgotpasswordurl");!common.isNull(a)&&a.length>3?(j$("#a_forgotpassword").show(),j$("#a_forgotpassword").html(stringres.get("forgotpassword_a")),j$("#a_forgotpassword").attr("href",a)):j$("#a_forgotpassword").hide()}else j$("#loginpage_container").hide(),j$("#settings_list").show(),j$("#btn_settings_menu").show();n();var s=!1;j$("#lp_btn_login").on("click",function(){if(!s){s=!0,setTimeout(function(){s=!1},1e3);var e=document.getElementById("lp_serveraddress");if(!common.isNull(e)&&1==j$("#lp_serveraddress").closest("div.ui-input-text").is(":visible")){var t=e.value;common.isNull(t)&&(t=""),t=common.Trim(t),t=t.toLowerCase(),common.NormalizeInput(t,0),common.SaveParameter("serveraddress_user",t)}if(!common.isNull(document.getElementById("lp_username"))){var o=document.getElementById("lp_username").value;common.isNull(o)&&(o=""),o=common.Trim(o),common.SaveParameter("sipusername",o)}if(!common.isNull(document.getElementById("lp_password"))){var n=document.getElementById("lp_password").value;common.isNull(n)&&(n=""),n=common.Trim(n),common.SaveParameter("password",n)}P(!0)}}),j$("#lp_serveraddress").closest("div.ui-input-text").hide(),common.isNull(document.getElementById("lp_serveraddress"))||(document.getElementById("lp_serveraddress").placeholder=stringres.get("sett_display_name_serveraddress_user")),common.isNull(document.getElementById("lp_username"))||(document.getElementById("lp_username").placeholder=stringres.get("sett_display_name_sipusername")),common.isNull(document.getElementById("lp_password"))||(document.getElementById("lp_password").placeholder=stringres.get("sett_display_name_password"));var r=common.GetConfig("logo"),c=document.getElementById("logo");if(!common.isNull(r)&&r.length>2&&!common.isNull(c)){var m=!1;(r.toLowerCase().indexOf(".jpg")>0||r.toLowerCase().indexOf(".jpeg")>0||r.toLowerCase().indexOf(".png")>0||r.toLowerCase().indexOf(".gif")>0)&&(m=!0),c.innerHTML=m?'<img src="'+common.GetElementSource()+"images/"+r+'" style="border: 0;">':"<span>"+r+"</span>"}n(),W=!1,i(),setTimeout(function(){if(!1===common.IsSDK()&&common.Glv()>1&&"true"!==common.GetParameter("androidchromedisplayed")&&(common.SaveParameter("androidchromedisplayed","true"),"Android"===common.GetOs())){var e=common.StrToInt(common.GetParameter2("enginepriority_webrtc")),t=common.StrToInt(common.GetParameter2("enginepriority_app")),n=common.CanIUseWebRTC();if(t<1||e<2||e>=t&&!0===n)return;var i=j$.mobile.activePage.find(".messagePopup");!common.isNull(i)&&i.length>0&&!0!==global.dontclosecurrpopup?j$.mobile.activePage.find(".messagePopup").popup("close").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),o()}}):o()}},3e3),50===common.GetConfigInt("brandid",-1)&&!0===global.favafone_autologin&&P()}catch(l){common.PutToDebugLogException(2,"_settings: onStart",l)}}function o(e){try{if("0"===common.GetParameter2("enginepriority_webrtc")||"0"===common.GetParameter2("enginepriority_app"))return;var t=common.GetDeviceWidth();t=!common.isNull(t)&&common.IsNumber(t)&&t>100?Math.floor(t/1.2):220;var o='<a href="javascript:;" id="pusenative">'+stringres.get("usenative_option_native")+"</a><br /><br />";o=o+'<a href="javascript:;" id="pusewebrtc">'+stringres.get("usenative_option_webrtc")+"</a>";var n='<div data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+t+'px;"><div data-role="header" data-theme="b"><h1 class="adialog_title">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'+stringres.get("usenative_title")+'</h1></div><div role="main" class="ui-content adialog_content adialog_alert"><span style="-ms-user-select: text; -moz-user-select: text; -khtml-user-select: text; -webkit-user-select: text;  user-select: text;"> '+o+" </span></div></div>";e=e||function(){},j$.mobile.activePage.append(n).trigger("create"),j$.mobile.activePage.find(".messagePopup").bind({popupbeforeposition:function(){j$(this).unbind("popupbeforeposition"),j$(".ui-popup-screen").off();var e=Math.floor(.6*common.GetDeviceHeight());j$(this).height()>e+100&&j$(".messagePopup .ui-content").height(e)}}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),e()}}),j$("#pusewebrtc").on("click",function(){webphone_api.flagrestartwebrtc=!0,j$.mobile.activePage.find(".messagePopup").popup("close"),common.ResetEngineClicked();var e=common.GetEngine("webrtc");e.clicked=2,common.SetEngine("webrtc",e),common.EngineSelect(1)}),j$("#pusenative").on("click",function(){webphone_api.flagrestartwebrtc=!1,j$.mobile.activePage.find(".messagePopup").popup("close"),common.ResetEngineClicked();var e=common.GetEngine("app");e.clicked=2,common.SetEngine("app",e),common.StartAppEngine(!0,"")})}catch(i){common.PutToDebugLogException(2,"_settings: OfferNativeEngine",i)}}function n(){try{j$("#page_settings").css("min-height","auto");var e=common.GetDeviceHeight()-j$("#settings_header").height()-3;if(M){var t=common.StrToIntPx(j$(".ui-input-search").css("margin-top"));e=e-j$("#settings_list").prev("form.ui-filterable").height()-t-t}if(j$("#settings_engine").is(":visible")&&(e=e-j$("#settings_engine").height()-2),j$("#settings_copyright").is(":visible")){var t=common.StrToIntPx(j$("#settings_copyright").css("margin-bottom"));e=e-j$("#settings_copyright").height()-t}if(j$("#settings_list").height(e),j$("#loginpage_container").height(e),j$("#loginpage").is(":visible")){var o=e-j$("#loginpage").height();o=Math.floor(o/2),j$("#loginpage").css("margin-top",o+"px")}var n=Math.floor(common.GetDeviceWidth()/4.6);j$("#app_name_settings").width(n)}catch(i){common.PutToDebugLogException(2,"_settings: MeasureSettingslist",i)}}function i(){try{if(K>18&&(common.PutToDebugLog(1,"ERROR, Failed to start"),common.PutToDebugLog(2,"ERROR, _settings GetAccounts File class failed to load")),common.isNull(global.File)&&K<20)return K++,void(F=setTimeout(function(){i()},200));common.isNull(F)||clearTimeout(F),F=null,common.isNull(global.aclist)||global.aclist.length<1?common.ReadAccountsFile(function(e){if(e){if(!common.isNull(common.settmap))for(var t in common.settmap)delete common.settmap[t];if(!common.isNull(common.settmap2))for(var t in common.settmap2)delete common.settmap2[t];W=!0,a()}else common.HandleSettings("","",function(){}),wpskininit_public.SkinLoaded(),s()}):(W=!0,a())}catch(e){common.PutToDebugLogException(2,"_settings: GetAccounts",e)}}function a(){try{if(common.isNull(common.settmap)||common.isNull(common.settmap.magicnumber)){var e=common.GetActiveAccSettingsFilename();common.isNull(e)||e.length<2?(common.HandleSettings("","",function(){}),wpskininit_public.SkinLoaded()):common.ReadSettingsFile(e,function(e){wpskininit_public.SkinLoaded(),s()})}else s()}catch(t){common.PutToDebugLogException(2,"_settings: GetSettings",t)}}function s(){try{if(common.DisplayStartPage("Settings"),"app"!==U){var e=!1,t=common.GetParameter("serveraddress_user"),o=common.GetParameter("upperserver"),n=common.GetSipusername(),i=common.GetParameter("password");"true"===common.GetParameter("serverinputisupperserver")?!common.isNull(o)&&o.length>2&&!common.isNull(n)&&n.length>2&&!common.isNull(i)&&i.length>2&&(e=!0):!0===common.GetParameterBool("customizedversion",!0)?!common.isNull(n)&&n.length>2&&!common.isNull(i)&&i.length>2&&(e=!0):!common.isNull(t)&&t.length>2&&!common.isNull(n)&&n.length>2&&!common.isNull(i)&&i.length>2&&(e=!0),common.IsWindowsSoftphone()&&common.WinAPI("API_GuiStarted",function(e){common.PutToDebugLog(2,"EVENT, _settings API_GuiStarted response: "+e)}),common.PutToDebugLog(2,"EVENT, _settings before StartWin");var a=common.GetAutostart();if(0===a&&(common.PutToDebugLog(3,"EVENT, settings autologin disabled because autostart is 0"),e=!1),!0===x()&&!0===C());else if(a<2&&0===common.GetParameterInt("lastsucc",-1)&&!1===common.IsSDK()){e=!1,common.PutToDebugLog(2,"WARNING,_settings AutoStart disabled, because last login was not successfull"),common.SaveParameter("last_login_failed","true");var s=common.GetParameter("serveraddress_user");(common.isNull(s)||s.length<1)&&(s=common.GetParameter("serveraddress_orig")),(common.isNull(s)||s.length<1)&&(s=common.GetParameter("serveraddress"));var r=common.GetSipusername(),c=common.GetParameter("password");r.length>0&&c.length>0&&(common.ShowServerInput()&&s.length>0||common.ShowServerInput())}var m=common.GetParameterInt("autologin",-1);if(0===m?e=!1:1===m&&(e=!0),e){if(document.getElementById("phone_app_main_container").style.display="block",common.ShowModalLoader(stringres.get("loading")),common.PutToDebugLogSpecial(1,"EVENT, _settings: onStart display Loading... modal loader_2",!1,""),z)return;return z=!0,setTimeout(function(){z=!1},1e3),j$.mobile.changePage("#page_dialpad",{transition:"pop",role:"page"}),setTimeout(function(){common.DisplayStartPage("Dialpad")},200),common.IsWindowsSoftphone()?setTimeout(function(){webphone_public.webphone_started=!1,webphone_api.startInner(common.GetSipusername(),common.GetParameter("password"))},100):setTimeout(function(){webphone_api.startInner(common.GetSipusername(),common.GetParameter("password"))},150),void setTimeout(function(){!0===common.UsePresence2()&&common.SetSelectedPresence("Offline",!1)},1e3)}l()}else common.HideModalLoader(),V=common.GetParameter("serveraddress_user"),l()}catch(g){common.PutToDebugLogException(2,"_settings: AutoStart",g)}}function r(){try{if(common.IsWindowsSoftphone())return;if(q)return;if(q=!0,0!==global.engineselectstage||common.GetTickCount()-global.engineselecttime>global.ENGINE_DELAY||global.webrtcavailable<0)c();else{var e=global.ENGINE_DELAY-(common.GetTickCount()-global.engineselecttime);e<0&&(e=1),setTimeout(function(){c()},e)}}catch(t){common.PutToDebugLogException(2,"_settings: EngineSelectStage1",t)}}function c(){try{common.isNull(Y)||(clearInterval(Y),Y=null),Y=setInterval(function(){if(J++,J>50&&(common.PutToDebugLog(2,"ERROR, _settings: EngineSelect timeout"),clearInterval(Y)),common.GetTickCount()-global.engineselecttime>global.ENGINE_DELAY){var e=common.EngineSelect(1);e<1||global.webrtcavailable<0?(e<1&&common.PutToDebugLog(2,"EVENT, _settings: waiting for EngineSelect ("+J+")"),global.webrtcavailable<0&&common.PutToDebugLog(2,"EVENT, _settings: waiting for WebRTC to load ("+J+")")):(clearInterval(Y),common.PutToDebugLog(2,"EVENT, _settings: selected engine("+global.engineselectstage+"): "+common.TestEngineToString(common.GetSelectedEngine(),!1)),common.PutToDebugLog(2,"EVENT, _settings: recommended engine("+global.engineselectstage+"): "+common.TestEngineToString(common.GetRecommendedEngine(),!1)),common.getuseengine()!==global.ENGINE_WEBRTC&&common.GetSelectedEngineName()!==global.ENGINE_WEBRTC||!0===common.UseTLSReload()&&common.TLSReload(),m())}},200)}catch(e){common.PutToDebugLogException(2,"settings: WaitForEngineSelectSetting",e)}}function m(e){try{if(!0===common.IsWindowsSoftphone())return;var t=common.GetSelectedEngineName();common.GetRecommendedEngineName();if(common.isNull(t)||t.length<1)return!1;(common.isNull(global.useengine)||global.useengine.length<2)&&("java"===common.GetSelectedEngineName()&&"MSIE"===common.GetBrowser()&&common.IsJavaInstalled()<2||(common.PutToDebugLog(2,"EVENT, Settings set useengine: "+t),global.useengine=t)),common.ShowEngineOptionOnPage(function(e,t){var o=common.GetParameter2("enginepriority_java"),n=common.GetParameter2("enginepriority_webrtc"),i=common.GetParameter2("enginepriority_ns"),a=common.GetParameter2("enginepriority_flash");"5"!==o&&"5"!==n&&"5"!==i&&"5"!==a&&(Q='<li data-icon="carat-d" id="settingitem_chooseengine"><a class="noshadow mlistitem"><div class="sett_text"><span class="sett_display_name">'+stringres.get("sett_chooseengine_title")+'</span><br><span id="sett_comment_engineservice" class="sett_comment">'+stringres.get("sett_chooseengine_comment")+"</span></div></a></li>")})}catch(o){common.PutToDebugLogException(2,"_settings: ShowEngineOptionSettings",o)}}function l(){try{if(common.DoVersioning(),r(),m(),common.SetCurrTheme(),b()&&(common.ShowServerInput()&&(common.SaveParameter("iswebrtcuppersrvfromuser","true"),"1"===common.GetParameter("showserverinput")&&common.GetConfigInt("upperserverfromuser",2)<2||(j$("#lp_serveraddress").val(common.GetParameter("serveraddress_user")),j$("#lp_serveraddress").closest("div.ui-input-text").show())),58!==common.GetConfigInt("brandid",-1)&&(j$("#lp_username").val(common.GetSipusername()),j$("#lp_password").val(common.GetParameter("password"))),"anonymous"===common.GetSipusername()&&j$("#lp_username").hide(),"nopassword"===common.GetParameter("password")&&j$("#lp_password").hide()),n(),common.isNull(document.getElementById("settings_list")))return void common.PutToDebugLog(2,"ERROR, _settings: PopulateList listelement is null");common.PutToDebugLog(5,"EVENT, _settings Starting populate list");var e="",t="";common.IsWindowsSoftphone()?(le&&common.PutToDebugLog(2,"EVENT, settings: Device: Windows softphone"),t=se,!1===common.ParameterIsDefault("startwithos",!0)&&(t=t.replace(",startwithos",""))):(le&&common.PutToDebugLog(2,"EVENT, settings: Device: browser webphone"),t=te,common.getuseengine()!==global.ENGINE_WEBRTC&&common.getuseengine()!==global.ENGINE_FLASH||(t=ne),"Android"!==common.GetOs()&&"iOS"!==common.GetOs()&&t.replace("enginepriority_nativedial,","")),50===common.GetConfigInt("brandid",-1)&&(ce="startwithos,loglevel,displayvolumecontrols,displayaudiodevice,savetocontacts",t="startwithos,loglevel,displayvolumecontrols,displayaudiodevice,savetocontacts"),B>0&&(t=oe),ue<3&&(t=ie),le=!1,!1===common.Glvd()&&(t=t.replace("videocodec,",""),t=t.replace("video_fps,",""),t=t.replace("video_profile,",""),t=t.replace("cfgvideo,",""),t=t.replace("video_height,",""),t=t.replace("video_width,",""),t=t.replace("video_bandwidth,",""),t=t.replace("video,","")),common.Glv()<2&&common.Glv()<1&&(t=t.replace("callforwardonbusy,",""),t=t.replace("callforwardonnoanswer,",""),t=t.replace("callforwardalways,",""),t=t.replace("calltransferalways,",""),t=t.replace("transfertype,",""),t=t.replace("conferencetype,",""));var o=ae.split(","),i=common.GetParameter("extraloginpageinputs"),a=[];!common.isNull(i)&&i.length>0&&(a=i.split(",")),common.isNull(a)&&(a=[]);for(var s=0;t.length>0&&s<5e3;){s++;var c="",l=t.indexOf(",");if(l<=0){if(!(t.length>0))break;l=t.length}var g=t.substring(0,l);if(t=l+1<t.length?common.Trim(t.substring(l+1)):"",!(common.isNull(g)||g.length<1)){var p=common.settmap2[g];if(!common.isNull(p)){var d=p[common.SETT_VALUE],u=p[common.SETT_TYPE],_=p[common.SETT_ISDEFAULT],f=0;try{f=common.StrToInt(common.Trim(p[common.SETT_GROUP])),common.isNull(f)&&(f=0)}catch(ee){common.PutToDebugLogException(3,"_settings: populateList settGrouping can't be converted to integer",ee)}var w=stringres.get("sett_display_name_"+g),E=stringres.get("sett_comment_"+g);stringres.get("sett_comment_short_"+g);if(!M)if(R){if(me===common.StrToInt(common.GROUP_LOGIN)){if(f!==me&&"accounts"!==g&&a.indexOf(g)<0)continue}else if(!0===common.GetParameterBool("customizedversion",!0)){if(ce.indexOf(g)<0)continue}else if(re.indexOf(g)<0)continue}else if(me===common.StrToInt(common.GROUP_PROFILE)){if(f!==me&&"displayname"!==g&&"email"!==g&&"presencestatus"!==g)continue;"displayname"===g&&(w=stringres.get("name"),E=stringres.get("displayname_login"))}else if(f!==me&&"accounts"!==g&&"ringtone"!==g&&"serveraddress_user"!==g)continue;if(!(60===common.GetConfigInt("brandid",-1)&&"username"===g||!0===common.GetParameterBool("customizedversion",!0)&&ue<4&&o.indexOf(g)>=0||!("accounts"!==g||me===common.StrToInt(common.GROUP_SIP)||me===common.StrToInt(common.GROUP_LOGIN)&&!common.isNull(global.sipaccounts)&&global.sipaccounts.length>1)||f===common.StrToInt(common.GROUP_INTEGRATE)))if(common.isNull(u)||u.length<1||"0"!==u&&"1"!==u&&"2"!==u&&"3"!==u&&"4"!==u&&"5"!==u&&"6"!==u&&"7"!==u&&"8"!==u)"-1"!==u&&common.PutToDebugLog(2,"ERROR, _settings: "+u+" is incorrectly defined in InitializeSettings");else if(!0!==common.HideSettings(g,w,g)){if("sipusername"===g){if("anonymous"===d)continue;if(!0===x())continue}if("password"===g){if("nopassword"===d)continue;if(!0===C())continue}if("serveraddress_user"===g){if(!common.ShowServerInput())continue;if(me!==common.StrToInt(common.GROUP_LOGIN)&&me!==common.StrToInt(common.GROUP_SIP))continue;if(common.SaveParameter("iswebrtcuppersrvfromuser","true"),!common.RequestUserServerInput())continue;w=common.GetParameter("server_label"),(w.toLowerCase().indexOf("op code")>=0||w.toLowerCase().indexOf("operator code")>=0)&&(E=stringres.get("sett_comment_serveraddress_user_operator"))}if("theme"!==g||"false"!==common.GetConfig("showtheme")&&!0!==common.GetParameterBool("customizedversion",!1)){if("loglevel_dbg"===g){var T=common.GetLogLevel();if(T<2)continue}if("telsearchkey"!==g||!(common.isNull(common.GetConfig("telsearchurl"))||common.GetConfig("telsearchurl").length<3)){if("icetimeout"===g){if(!0===common.IsWindowsSoftphone())continue;var j=common.GetParameterInt("enginepriority_webrtc",2);if(j<1)continue;var y=common.GetParameterInt("enginepriority_java",2),$=common.GetParameterInt("enginepriority_ns",2),G=common.GetParameterInt("enginepriority_flash",2),I=common.GetParameterInt("enginepriority_app",2),N=common.GetParameterInt("enginepriority_p2p",2),L=common.GetParameterInt("enginepriority_accessnum",2),D=common.GetParameterInt("enginepriority_nativedial",2);if(j<3&&(y>3||$>3||G>3||I>3||N>3||L>3||D>3))continue}var O="";if(O="0"===_||"sipusername"===g||"password"===g||"serveraddress_user"===g?v(g)+" "+h(g):v(g),"true"===common.GetParameter("serverinputisupperserver")&&"serveraddress_user"===g&&(O=2===common.GetParameterInt("brandid",-1)?stringres.get("sett_comment_serveraddress_user_gmsdialer")+" "+h(g):v(g)+" "+h(g)),"serveraddress_user"===g&&common.GetConfig("server_comment").length>1&&(O=common.GetConfig("server_comment")+" "+h(g)),"transport"!==g||"true"!==common.GetParameter("serverinputisupperserver")&&!0!==common.GetParameterBool("autotransportdetect",!1)){try{if(window.location.href.indexOf("isdemopage=true")>0&&("sipusername"===g||"username"===g||"password"===g||"sippassword"===g||"serveraddress_user"===g||"serveraddress_orig"===g||"serveraddress"===g||"upperserver"===g||"callto"===g||"destination"===g)){var A=webphone_api.getparameter(g);"sipusername"===g&&A.length<1&&(A=webphone_api.getparameter("username")),"serveraddress_user"===g&&A.length<1&&!1===common.RequestUserServerInput()&&(A=webphone_api.getparameter("serveraddress")),!common.isNull(A)&&A.length>0&&(common.isNull(d)||d.length<1)&&(webphone_api.setparameter(g,A),d=A)}}catch(pe){common.PutToDebugLogException(2,"_settings: Populateliet inner1",pe)}if(c='<li data-icon="[SETTICON]" id="[ITEMID]" title="[SETT_TITLE]"><a class="noshadow mlistitem"><div class="sett_text"><span class="sett_display_name">[DISPLAYNAME]</span><br><span id="[COMMENTID]" class="sett_comment">[COMMENT]</span></div>[TRUEFALSEIMG]</a></li>',"0"===u){if("flash"===g||"sscontrol"===g||"ssscroll"===g||"sstop"===g?d="2"===d?"true":"false":"beeponincoming"===g&&(d="1"===d?"true":"false"),"loglevel"===g){var V=common.StrToInt(d);c=V>1?c.replace("[TRUEFALSEIMG]",'<div class="sett_image"><img src="'+common.GetElementSource()+'images/checkbox_true.png" id="img_'+g+'" /></div>'):c.replace("[TRUEFALSEIMG]",'<div class="sett_image"><img src="'+common.GetElementSource()+'images/checkbox_false.png" id="img_'+g+'" /></div>')}else c="true"===d?c.replace("[TRUEFALSEIMG]",'<div class="sett_image"><img src="'+common.GetElementSource()+'images/checkbox_true.png" id="img_'+g+'" /></div>'):c.replace("[TRUEFALSEIMG]",'<div class="sett_image"><img src="'+common.GetElementSource()+'images/checkbox_false.png" id="img_'+g+'" /></div>');c=c.replace("[SETTICON]","false")}else c=c.replace("[TRUEFALSEIMG]","");"1"!==u&&"2"!==u&&"3"!==u&&"4"!==u&&"5"!==u&&"7"!==u&&"8"!==u||(c=c.replace("[SETTICON]","carat-d")),"6"===u&&(c=c.replace("[SETTICON]","carat-r")),c=c.replace("[ITEMID]","settingitem_"+g),c=c.replace("[DISPLAYNAME]",w),c=c.replace("[COMMENT]",O),c=c.replace("[COMMENTID]","sett_comment_"+g),c=c.replace("[SETT_TITLE]",E),e+=c}}}}}}}}catch(de){common.PutToDebugLogException(2,"_settings: PopulateList",de)}setTimeout(function(){common.HideModalLoader()},800);var H=!0;if(!1===M){if(("app"!==U||common.GetParameter("sipusername").length<1||common.GetParameter("password").length<1)&&me===common.StrToInt(common.GROUP_LOGIN)){H=!1;e+='<li data-icon="carat-r" id="settingitem_advancedloginsettings" title="'+stringres.get("sett_comment_advancedloginsettings")+'"><a class="noshadow mlistitem"><div class="sett_text"><span class="sett_display_name">'+stringres.get("sett_display_name_advancedloginsettings")+'</span><br><span id="sett_comment_advancedloginsettings" class="sett_comment">'+stringres.get("sett_comment_advancedloginsettings")+"</span></div></a></li>"}if((!1===common.GetParameterBool("customizedversion",!0)||"app"===U||common.GetParameter("newuser_second").length>3)&&me===common.StrToInt(common.GROUP_LOGIN)&&H){e+='<li data-icon="carat-r" id="settingitem_entersettings" title="'+stringres.get("sett_comment_entersettings")+'"><a class="noshadow mlistitem"><div class="sett_text"><span class="sett_display_name">'+stringres.get("sett_display_name_entersettings")+'</span><br><span id="sett_comment_advancedsettings" class="sett_comment">'+stringres.get("sett_comment_entersettings")+"</span></div></a></li>"}if(R&&me===common.StrToInt(common.GROUP_MAIN)&&ue>2&&B<1){e+='<li data-icon="carat-r" id="settingitem_advancedsettings" title="'+stringres.get("sett_comment_submenu_advanced")+'"><a class="noshadow mlistitem"><div class="sett_text"><span class="sett_display_name">'+stringres.get("sett_display_name_advancedsettings")+'</span><br><span id="sett_comment_advancedsettings" class="sett_comment">'+stringres.get("sett_comment_advancedsettings")+"</span></div></a></li>"}if(1==B&&me===common.StrToInt(common.GROUP_MAIN)){e+='<li data-icon="carat-r" id="settingitem_moresettings" title="'+stringres.get("sett_comment_moresettings")+'"><a class="noshadow mlistitem"><div class="sett_text"><span class="sett_display_name">'+stringres.get("sett_display_name_moresettings")+'</span><br><span id="sett_comment_moresettings" class="sett_comment">'+stringres.get("sett_comment_moresettings")+"</span></div></a></li>"}}!1===common.IsWindowsSoftphone()&&(!0===global.isdebugversion_showengineselection||common.GetParameterInt("enproblem",0)>0||!0===common.GetParameterBool("last_login_failed",!1)&&me===common.StrToInt(common.GROUP_MAIN))?(Q='<li data-icon="carat-d" id="settingitem_chooseengine"><a class="noshadow mlistitem"><div class="sett_text"><span class="sett_display_name">'+stringres.get("sett_chooseengine_title")+'</span><br><span id="sett_comment_engineservice" class="sett_comment">'+stringres.get("sett_chooseengine_comment")+"("+common.GetEngineDisplayName(common.GetSelectedEngineName())+")</span></div></a></li>",e=Q+e):(me===common.StrToInt(common.GROUP_LOGIN)&&"1"===common.GetParameter("lastsessionsuccess")||me===common.StrToInt(common.GROUP_SIP)&&!1===R)&&(common.isNull(Q)&&(Q=""),e=Q+e);var W="";W="app"===U&&!0===ge?stringres.get("btn_save"):stringres.get("btn_login");var F='<li id="settings_footer"><button id="btn_login" title="'+stringres.get("hint_settlogin")+'" class="ui-btn ui-btn-corner-all ui-btn-b noshadow">'+W+"</button></li>",K=common.GetSipusername();common.isNull(K)&&(K="");var z=common.GetParameter("password");common.isNull(z)&&(z="");var q="";if(!0===common.IsWindowsSoftphone()){var Y=common.GetParameterInt("qrcode_login",0);1==Y?(K.length<1||z.lenght<1)&&(q='<li id="qrcode_layout"><button id="btn_qrcode_login" class="ui-btn ui-btn-corner-all ui-btn-b noshadow">'+stringres.get("btn_qrcode")+"</button></li>"):2==Y&&(q='<li id="qrcode_layout"><button id="btn_qrcode_login" class="ui-btn ui-btn-corner-all ui-btn-b noshadow">'+stringres.get("btn_qrcode")+"</button></li>")}(me===common.StrToInt(common.GROUP_LOGIN)||K.length>0&&z.length>0)&&(e=e+q+F);var J=common.GetParameter("newuser");!common.isNull(J)&&J.length>2&&"app"!==U&&me===common.StrToInt(common.GROUP_LOGIN)&&(e=e+'<a href="javascript:;" id="al_newuser" title="'+stringres.get("hint_btnnewuser")+'" class="settings_links" target="_blank">'+stringres.get("newuser")+"</a>"),j$("#settings_list").html(""),j$("#settings_list").append(e).listview("refresh"),j$("#al_newuser").on("click",function(e){S(),e.preventDefault()});var X=!1;j$("#btn_qrcode_login").on("click",function(){X||(X=!0,setTimeout(function(){X=!1},1e3),common.PutToDebugLog(3,"EVENT, settings button QRcode login clicked"),k())});var Z=!1;j$("#btn_login").on("click",function(){Z||(Z=!0,setTimeout(function(){Z=!1},1e3),common.PutToDebugLog(3,"EVENT, settings button login clicked"),P(!0),me=20)}),j$("#btn_cancel").on("click",function(){alert("Cancel")}),common.PutToDebugLog(5,"EVENT, _settings List populated")}function g(e){try{if(common.PutToDebugLog("EVENT, _settings: OnListItemClick click, id: "+e),"chooseengine"===e)return global.enablewebrtc=!global.enablewebrtc,void l();if(common.isNull(e)||e.length<1)return void common.PutToDebugLog(2,"ERROR, _settings OnListItemClick id is NULL");if("settingitem_entersettings"===e)return void $();if("settingitem_advancedloginsettings"===e)return void G();if("settingitem_advancedsettings"===e)return void I();if("settingitem_moresettings"===e)return B=0,void $();if("settingitem_chooseengine"===e){var t=common.GetEngineList();if(common.isNull(t)||t.length<2)return;common.IsServiceInstalled(function(e){de=!0===e},!0),pe=[];for(var o=common.GetSelectedEngineName(),n=common.GetRecommendedEngineName(),i=0;i<t.length;i++){var a=t[i];if(!(common.isNull(a)||common.isNull(o)||o.length<1||"java"!==a.name&&"webrtc"!==a.name&&"ns"!==a.name&&"app"!==a.name&&"flash"!==a.name)){var s=a.defpriority,r="0";a.name===o?(r="3",s*=10):a.name===n?(r="2",s*=4):common.EngineIsSupported(a.name)>0&&(r="1");var c=common.StrToInt(r),m=[];m[0]=a.name,m[1]=r,m[2]=(c*s).toString(),pe.push(m)}}if(common.isNull(pe)||pe.length<1)return;pe.sort(function(e,t){return e[2]>t[2]?-1:e[2]<t[2]?1:0});for(var i=0;i<pe.length;i++)var m=pe[i];for(var g="",i=0;i<pe.length;i++){var v=pe[i];if(!(common.isNull(v)||v.length<1)){var m='<input name="'+P+'" id="[INPUTID]" value="[VALUE]" [CHECKED] [DISABLED] type="radio"><label for="[INPUTID]" [NOTBOLD]>[LABEL]</label>';m=m.replace("[INPUTID]","ensel_"+v[0]),m=m.replace("[INPUTID]","ensel_"+v[0]),m=m.replace("[VALUE]",v[0]),"3"===v[1]?(m=m.replace("[CHECKED]",'checked="checked"'),m=m.replace("[LABEL]",common.GetEngineDisplayName(v[0])+" ("+stringres.get("sett_ce_highly")+")"),
m=m.replace("[NOTBOLD]","")):"2"===v[1]?(m=m.replace("[LABEL]",common.GetEngineDisplayName(v[0])+" ("+stringres.get("sett_ce_recommended")+")"),m=m.replace("[NOTBOLD]","")):"0"===v[1]&&(m=m.replace("[DISABLED]",'disabled="disabled"')),m=m.replace("[CHECKED]",""),m=m.replace("[DISABLED]",""),m=m.replace("[NOTBOLD]",'style="font-weight: normal;"'),m=m.replace("[LABEL]",common.GetEngineDisplayName(v[0])),g+=m}}var h=common.GetDeviceWidth();h=!common.isNull(h)&&common.IsNumber(h)&&h>100?Math.floor(h/1.2):220;var f='<div id="settings_user_ce_select" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+h+"px; min-width: "+Math.floor(.6*h)+'px;"><div data-role="header" data-theme="b"><a href="javascript:;" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+stringres.get("sett_chooseengine_popup_title")+'</h1></div><div role="main" class="ui-content adialog_content_select"><fieldset id="settings_select_2" data-role="controlgroup">'+g+'</fieldset></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" id="adialog_positive" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_ok")+'</a><a href="javascript:;" id="adialog_negative" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back">'+stringres.get("btn_cancel")+"</a></div></div>",b=function(){};return j$.mobile.activePage.append(f).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(e){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),b()}}),void j$("#adialog_positive").on("click",function(e){var t=j$("#settings_select_2 :radio:checked").val();if(common.ResetEngineClicked(),common.PutToDebugLog(3,"EVENT, _settings: selected engine by user: "+t),j$("#sett_comment_engineservice").html(stringres.get("sett_chooseengine_comment")+"("+common.GetEngineDisplayName(t)+")"),"java"===t);else if("webrtc"===t)common.PutToDebugLog(2,"EVENT, _settings: chooseengine reset useengine_1"),global.useengine="";else if("ns"===t){var o=common.GetEngine(t);if(common.isNull(o)||(common.PutToDebugLog(2,"EVENT, _settings: chooseengine reset useengine_2"),global.useengine="",o.clicked=2,common.SetEngine(t,o),common.IsServiceInstalled(function(e){!0===e&&(de=!0,common.ShowToast(common.GetEngineDisplayName(t)+" "+stringres.get("ce_use"),3e3,function(){}))},!0),common.EngineSelect(1)),!1===de){setTimeout(function(){common.NPDownloadAndInstall()},350);var n=common.GetNPLocation();!common.isNull(n)&&n.length>0&&window.open(n)}}else"flash"===t&&(common.PutToDebugLog(2,"EVENT, _settings: chooseengine reset useengine_3"),global.useengine="");if("ns"!==t){var o=common.GetEngine(t);common.isNull(o)||(common.PutToDebugLog(2,"EVENT, _settings: chooseengine reset useengine_4"),global.useengine="",o.clicked=2,common.SetEngine(t,o),common.ShowToast(common.GetEngineDisplayName(t)+" "+stringres.get("ce_use"),3e3,function(){common.ChooseEngineLogic2(t)}),common.EngineSelect(1))}})}if(ge=!0,"settings_footer"===e||"newuser_container"===e)return;global.wasSettModified=!0;var P=e.replace("settingitem_",""),w=common.settmap2[P];if(common.isNull(w)||w.length<1)return void common.PutToDebugLog(2,"ERROR, _settings OnListItemClick settings NULL: "+P);var E=w[common.SETT_VALUE],k=w[common.SETT_TYPE],S=w[common.SETT_ALLNAMES],T=w[common.SETT_ALLVALUES],j=(w[common.SETT_GROUP],stringres.get("sett_display_name_"+P)),y=stringres.get("sett_comment_"+P);if(50===common.GetConfigInt("brandid",-1)&&("sipusername"===P&&(y="Your Favafone Username"),"password"===P&&(y="Your Favafone Password")),null===k||k.length<=0||"0"!==k&&"1"!==k&&"2"!==k&&"3"!==k&&"4"!==k&&"5"!==k&&"6"!==k&&"7"!==k&&"8"!==k)return void common.PutToDebugLog(2,"ERROR, _settings OnListItemClick invalid type");var N=common.GetDeviceWidth();if(N=!common.isNull(N)&&common.IsNumber(N)&&N>100?Math.floor(N/1.2):220,"0"===k){if("loglevel"===P){if("1"===E){E=global.predefLoglevel;var L=common.GetMaxLogLevel();E>L&&(E=L),common.SaveParameter("jsscriptevent","3"),webphone_api.setparameter("jsscriptevent","3"),common.SaveParameter("loglastusage",common.GetTickCount())}else E="1",common.SaveParameter("jsscriptevent","2"),webphone_api.setparameter("jsscriptevent","2");!1===R&&l()}else E="flash"===P||"sscontrol"===P||"ssscroll"===P||"sstop"===P?"2"===E?"1":"2":"beeponincoming"===P?"1"===E?"true":"false":"true"===E?"false":"true";"startwithos"===P&&common.SaveParameter("startwithos_was_sent","false");var D="";if(D=j$("#img_"+P).attr("src"),common.isNull(D)||D.lenght<1)return void common.PutToDebugLog(2,"ERROR, _settings imgsrc NULL");D=D.indexOf("true")>=0?D.replace("true","false"):D.replace("false","true"),j$("#img_"+P).attr("src",D),w[common.SETT_VALUE]=E,w[common.SETT_ISDEFAULT]="0",common.settmap[P]=w,common.settmap2[P]=w,"loglevel"===P&&!1===R&&l(),_(P)}if("1"===k){if(me===common.StrToInt(common.GROUP_PROFILE)&&"displayname"===P&&(y=stringres.get("displayname_login")),"profilepicture"===P)return void p();var f='<div id="settings_type_1" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+N+'px;"><div data-role="header" data-theme="b"><a href="javascript:;" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+j+'</h1></div><div role="main" class="ui-content adialog_content"><span>'+y+'</span><input type="text" id="setting_item_input" name="setting_item" data-theme="a" autocapitalize="off"/></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" id="adialog_positive" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_ok")+'</a><a href="javascript:;" id="adialog_negative" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back">'+stringres.get("btn_cancel")+"</a></div></div>",b=function(){};j$.mobile.activePage.append(f).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(e){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),j$("#adialog_positive").off("click"),j$("#adialog_negative").off("click"),b()}});var x=document.getElementById("setting_item_input");if(!common.isNull(E)&&E.length>0&&!common.isNull(x))if("password"===P)x.value="*****";else if("ringtimeout"===P||"calltimeout"===P||"icetimeout"===P||"keepaliveival"===P||"wskeepaliveival"===P||"closecall_timeout"===P){var C=common.StrToInt(E,-1e4);C>=2&&C<=999?x.value=E:(C=Math.floor(C),E=C.toString(),x.value=E)}else"sipusername"===P?common.isNull(E)||E.length<1?x.value=common.GetSipusername():x.value=E:"loglevel_dbg"===P?(E=common.GetParameter("loglevel"),x.value=E):x.value=E;setTimeout(function(){common.isNull(x)||x.focus()},150),j$("#adialog_positive").on("click",function(e){"MSIE"===common.GetBrowser()&&e.preventDefault(),common.PutToDebugLog(5,"EVENT, settings onListItemClick 1 ok ("+P+")"),u(j$.mobile.activePage.find(".messagePopup"));var t="";if(common.isNull(x)||(t=x.value),!common.isNull(t)){if(t=common.Trim(t),"ringtimeout"===P||"calltimeout"===P||"icetimeout"===P||"keepaliveival"===P||"wskeepaliveival"===P||"closecall_timeout"===P){var o=common.StrToInt(t,-1e4);o>=2&&o<=999&&(o*=1e3),t=o.toString()}if(E=common.Trim(t),"sipusername"===P&&(E=common.NormalizeInput(E,0)),"loglevel"===P){(common.isNull(E)||E.length<1)&&(E="1");var n=1;try{n=common.StrToInt(E)}catch(i){}global.loglevel=n}else"loglevel_dbg"===P&&!common.isNull(E)&&E.length>0&&common.SaveParameter("loglevel",E);if("password"===P&&t.indexOf("**")>=0)return;w[common.SETT_VALUE]=E,w[common.SETT_ISDEFAULT]="0",common.settmap[P]=w,common.settmap2[P]=w,_(P)}}),j$("#adialog_negative").on("click",function(e){"MSIE"===common.GetBrowser()&&e.preventDefault(),u(j$.mobile.activePage.find(".messagePopup"))})}if("2"===k){for(var O=S,A=T,U=0,M=O;M.indexOf(",")>0;)M=M.substring(M.indexOf(",")+1,M.length),U++;U++;var V,H;V=[],H=[];var W=0;for(M=O;W<U;)M.indexOf(",")>0?(V[W]=M.substring(0,M.indexOf(",")),M=M.substring(M.indexOf(",")+1,M.length)):V[W]=M.substring(0,M.length),W++;W=0;for(var F=A;W<U;)F.indexOf(",")>0?(H[W]=F.substring(0,F.indexOf(",")),F=F.substring(F.indexOf(",")+1,F.length)):H[W]=F.substring(0,F.length),W++;for(var g="",i=0;i<V.length;i++){var m='<input name="'+P+'" id="[INPUTID]" value="[VALUE]" [CHECKED] type="radio"><label for="[INPUTID]">[LABEL]</label>';m=m.replace("[INPUTID]",P+"_"+i),m=m.replace("[INPUTID]",P+"_"+i),m=m.replace("[VALUE]",H[i]),m=m.replace("[LABEL]",V[i]),m=H[i]===E?m.replace("[CHECKED]",'checked="checked"'):m.replace("[CHECKED]",""),g+=m}var K=common.GetDeviceHeight();K=!common.isNull(K)&&common.IsNumber(K)&&K>100?Math.floor(K/1.2):300;var f='<div id="settings_type_2" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+N+"px; min-width: "+Math.floor(.6*N)+'px;"><div data-role="header" data-theme="b"><a href="javascript:;" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+j+'</h1></div><div role="main" class="ui-content adialog_content_select" style="max-height: '+K+'px;"><fieldset id="settings_select_2" data-role="controlgroup">'+g+"</fieldset></div></div>",b=function(){};j$.mobile.activePage.append(f).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(e){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),b()}}),j$(":radio").on("change",function(e){if(u(j$.mobile.activePage.find(".messagePopup")),j$.mobile.activePage.find(".messagePopup").popup("close"),E=j$(this).attr("value"),common.IsWindowsSoftphone()&&"true"==common.GetConfig("needactivation")&&"true"!==common.GetParameter("canshowlickeyinput")&&("transport"===P&&"2"===E||"mediaencryption"===P&&"2"===E))return void common.ShowToast(stringres.get("warning_feature"),6e3);if(w[common.SETT_VALUE]=E,w[common.SETT_ISDEFAULT]="0",common.settmap[P]=w,common.settmap2[P]=w,_(P),"theme"===P){if(common.SetCurrTheme(),common.IsWindowsSoftphone()){var t=common.AddJscommport(global.WIN_SOFTPHONE_URL)+"?extcmd_theme="+E;common.WinSoftphoneHttpReq(t,"GET","",function(e){common.PutToDebugLog(2,"EVENT, send theme to softphone response: "+e)})}}else"language"===P&&common.SetLanguage()})}if("3"===k)if("videocodec"===P){var g='<input name="'+P+'" id="videocodec_optimal" [CHECKED_OPTIMAL] type="checkbox"><label for="videocodec_optimal">'+stringres.get("videocodec_optimal")+'</label><input name="'+P+'" id="videocodec_h264" [CHECKED_H264] type="checkbox"><label for="videocodec_h264">H264</label><input name="'+P+'" id="videocodec_vp8" [CHECKED_VP8] type="checkbox"><label for="videocodec_vp8">VP8</label><input name="'+P+'" id="videocodec_vp9" [CHECKED_VP9] type="checkbox"><label for="videocodec_vp9">VP9</label>';if("-1"===E)g=g.replace("[CHECKED_OPTIMAL]",'checked="checked"'),g=g.replace("[CHECKED_H264]",""),g=g.replace("[CHECKED_VP8]",""),g=g.replace("[CHECKED_VP9]","");else{g=g.replace("[CHECKED_OPTIMAL]","");var z='checked="checked"';!1===common.GetParameterBool("use_h264",!0)&&(z=""),g=g.replace("[CHECKED_H264]",z);var q='checked="checked"';!1===common.GetParameterBool("use_vp8",!0)&&(q=""),g=g.replace("[CHECKED_VP8]",q);var Y='checked="checked"';!1===common.GetParameterBool("use_vp9",!0)&&(Y=""),g=g.replace("[CHECKED_VP9]",Y)}var f='<div id="settings_type_3" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" data-dismissible="false" style="max-width:'+N+"px; min-width: "+Math.floor(.6*N)+'px;"><div data-role="header" data-theme="b"><h1 class="adialog_title">'+j+'</h1></div><div role="main" class="ui-content adialog_content_select"><fieldset id="settings_select_3" data-role="controlgroup">'+g+'</fieldset></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" style="width: 98%;" id="adialog_positive" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_ok")+"</a></div></div>",b=function(){};j$.mobile.activePage.append(f).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(e){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").bind({popupbeforeposition:function(){j$(this).unbind("popupbeforeposition");var e=Math.floor(.7*common.GetDeviceHeight());j$(this).height()>e&&j$(".messagePopup .ui-content").height(e)}}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),j$("#adialog_positive").off("click"),b()}}),j$(":checkbox").on("change",function(e){"videocodec_optimal"===j$(this).attr("id")?(j$("#videocodec_h264").prop("checked",!1).checkboxradio("refresh"),j$("#videocodec_vp8").prop("checked",!1).checkboxradio("refresh"),j$("#videocodec_vp9").prop("checked",!1).checkboxradio("refresh")):j$("#videocodec_optimal").prop("checked",!1).checkboxradio("refresh")}),j$("#adialog_positive").on("click",function(e){if("MSIE"===common.GetBrowser()&&e.preventDefault(),common.PutToDebugLog(5,"EVENT, settings onListItemClick videocodec ok"),u(j$.mobile.activePage.find(".messagePopup")),E="",j$("#videocodec_optimal").prop("checked"))E="-1",common.SaveParameter("use_h264","true"),common.SaveParameter("use_vp8","true"),common.SaveParameter("use_vp9","true");else{E="1";var t="false";j$("#videocodec_h264").prop("checked")&&(t="true"),common.SaveParameter("use_h264",t);var o="false";j$("#videocodec_vp8").prop("checked")&&(o="true"),common.SaveParameter("use_vp8",o);var n="false";j$("#videocodec_vp9").prop("checked")&&(n="true"),common.SaveParameter("use_vp9",n)}w[common.SETT_VALUE]=E,w[common.SETT_ISDEFAULT]="0",common.settmap[P]=w,common.settmap2[P]=w,_(P)})}else if("codec"===P){for(var J=S,Q=T,X=J.split(","),Z=Q.split(","),ee=E.split(","),te=0;te<ee.length;te++)if("-1"===ee[te]){ee=["-1"];break}for(var g="",i=0;i<X.length;i++){var m='<input name="'+P+'" id="[INPUTID]" value="[VALUE]" [CHECKED] type="checkbox"><label for="[INPUTID]">[LABEL]</label>';if(m=m.replace("[INPUTID]",P+"_"+i),m=m.replace("[INPUTID]",P+"_"+i),m=m.replace("[VALUE]",Z[i]),m=m.replace("[LABEL]",X[i]),"Optimal"===X[i]){for(var oe=0;oe<ee.length;oe++)if("-1"===ee[oe]){m=m.replace("[CHECKED]",'checked="checked"');break}m=m.replace("[CHECKED]",""),g+=m}if("PCMU"===X[i]){for(var oe=0;oe<ee.length;oe++)if("1"===ee[oe]){m=m.replace("[CHECKED]",'checked="checked"');break}m=m.replace("[CHECKED]",""),g+=m}if("PCMA"===X[i]){for(var oe=0;oe<ee.length;oe++)if("2"===ee[oe]){m=m.replace("[CHECKED]",'checked="checked"');break}m=m.replace("[CHECKED]",""),g+=m}if("GSM"===X[i]){for(var oe=0;oe<ee.length;oe++)if("3"===ee[oe]){m=m.replace("[CHECKED]",'checked="checked"');break}m=m.replace("[CHECKED]",""),g+=m}if("iLBC"===X[i]){for(var oe=0;oe<ee.length;oe++)if("4"===ee[oe]){m=m.replace("[CHECKED]",'checked="checked"');break}m=m.replace("[CHECKED]",""),g+=m}if("SPEEX"===X[i]){for(var oe=0;oe<ee.length;oe++)if("5"===ee[oe]){m=m.replace("[CHECKED]",'checked="checked"');break}m=m.replace("[CHECKED]",""),g+=m}if("SPEEX-WB"===X[i]){for(var oe=0;oe<ee.length;oe++)if("6"===ee[oe]){m=m.replace("[CHECKED]",'checked="checked"');break}m=m.replace("[CHECKED]",""),g+=m}if("Opus"===X[i]){for(var oe=0;oe<ee.length;oe++)if("6"===ee[oe]){m=m.replace("[CHECKED]",'checked="checked"');break}m=m.replace("[CHECKED]",""),g+=m}if("OpusWB"===X[i]){for(var oe=0;oe<ee.length;oe++)if("6"===ee[oe]){m=m.replace("[CHECKED]",'checked="checked"');break}m=m.replace("[CHECKED]",""),g+=m}if("OpusSWB"===X[i]){for(var oe=0;oe<ee.length;oe++)if("6"===ee[oe]){m=m.replace("[CHECKED]",'checked="checked"');break}m=m.replace("[CHECKED]",""),g+=m}if("OpusUWB"===X[i]){for(var oe=0;oe<ee.length;oe++)if("6"===ee[oe]){m=m.replace("[CHECKED]",'checked="checked"');break}m=m.replace("[CHECKED]",""),g+=m}if("G.729"===X[i]){for(var oe=0;oe<ee.length;oe++)if("8"===ee[oe]){m=m.replace("[CHECKED]",'checked="checked"');break}m=m.replace("[CHECKED]",""),g+=m}}var f='<div id="settings_type_3" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" data-dismissible="false" style="max-width:'+N+"px; min-width: "+Math.floor(.6*N)+'px;"><div data-role="header" data-theme="b"><h1 class="adialog_title">'+j+'</h1></div><div role="main" class="ui-content adialog_content_select"><fieldset id="settings_select_3" data-role="controlgroup">'+g+'</fieldset></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" style="width: 98%;" id="adialog_positive" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_ok")+"</a></div></div>",b=function(){};j$.mobile.activePage.append(f).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(e){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").bind({popupbeforeposition:function(){j$(this).unbind("popupbeforeposition");var e=Math.floor(.7*common.GetDeviceHeight());j$(this).height()>e&&j$(".messagePopup .ui-content").height(e)}}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),j$("#adialog_positive").off("click"),b()}}),j$(":checkbox").on("change",function(e){var t=j$(this).attr("value");if("-1"===t)if(j$("#"+P+"_0").prop("checked"))for(var o=1;o<X.length;o++)j$("#"+P+"_"+o).prop("checked",!1).checkboxradio("refresh");else for(var o=0;o<X.length;o++)"PCMU"!==X[o]&&"PCMA"!==X[o]&&"GSM"!==X[o]||j$("#"+P+"_"+o).prop("checked",!0).checkboxradio("refresh");else{if("8"===t&&common.IsWindowsSoftphone()&&"true"==common.GetConfig("needactivation")&&"true"!==common.GetParameter("canshowlickeyinput"))return j$("#"+P+"_7").prop("checked",!1).checkboxradio("refresh"),j$.mobile.activePage.find(".messagePopup").popup("close"),void setTimeout(function(){common.ShowToast(stringres.get("warning_feature"),6e3)},100);j$("#"+P+"_0").prop("checked",!1).checkboxradio("refresh")}}),j$("#adialog_positive").on("click",function(e){"MSIE"===common.GetBrowser()&&e.preventDefault(),common.PutToDebugLog(5,"EVENT, settings onListItemClick 3 ok"),u(j$.mobile.activePage.find(".messagePopup")),E="";for(var t=0;t<X.length;t++)if(j$("#"+P+"_"+t).prop("checked")){var o="";E.length>0&&(o=","),E=E+o+document.getElementById(P+"_"+t).value}w[common.SETT_VALUE]=E,w[common.SETT_ISDEFAULT]="0",common.settmap[P]=w,common.settmap2[P]=w,_(P)})}if("4"===k){var f='<div id="settings_type_4" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+N+'px;"><div data-role="header" data-theme="b"><a href="javascript:;" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+j+'</h1></div><div role="main" class="ui-content adialog_content"><span>'+y+'</span><input type="text" id="setting_item_input" name="setting_item" data-theme="a" autocapitalize="off"/></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" id="adialog_positive" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_ok")+'</a><a href="javascript:;" id="adialog_negative" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back">'+stringres.get("btn_cancel")+"</a></div></div>",b=function(){};j$.mobile.activePage.append(f).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(e){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),j$("#adialog_positive").off("click"),j$("#adialog_negative").off("click"),b()}});var x=document.getElementById("setting_item_input");!common.isNull(E)&&E.length>0&&!common.isNull(x)&&(("ringtimeout"===P||"calltimeout"===P)&&P.length>3?(E=E.substring(0,E.length-3),x.value=E):x.value=E),setTimeout(function(){common.isNull(x)||x.focus()},150),j$("#adialog_positive").on("click",function(e){"MSIE"===common.GetBrowser()&&e.preventDefault(),common.PutToDebugLog(5,"EVENT, settings onListItemClick 2 ok ("+E+")"),u(j$.mobile.activePage.find(".messagePopup"));var t="";common.isNull(x)||(t=x.value),!common.isNull(t)&&t.length>0&&(E=common.Trim(t),w[common.SETT_VALUE]=E,w[common.SETT_ISDEFAULT]="0",common.settmap2[P]=w,_(P))}),j$("#adialog_negative").on("click",function(e){"MSIE"===common.GetBrowser()&&e.preventDefault(),u(j$.mobile.activePage.find(".messagePopup"))})}if("5"===k&&("filters"===P?j$.mobile.changePage("#page_filters",{transition:"slide",role:"page"}):"accounts"===P?j$.mobile.changePage("#page_accounts",{transition:"slide",role:"page"}):alert("not implemented yet")),"6"===k&&("submenu_sipsettings"===P?d():"submenu_media"===P?(me=common.StrToInt(common.Trim(common.GROUP_MEDIA)),l(),j$("#btn_back_settings").show(),j$("#app_name_settings").hide(),j$("#settings_page_title").html(j),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("settings_title"))):"submenu_video"===P?(me=common.StrToInt(common.Trim(common.GROUP_VIDEO)),l(),j$("#btn_back_settings").show(),j$("#app_name_settings").hide(),j$("#settings_page_title").html(j),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("sett_display_name_submenu_media"))):"submenu_calldivert"===P?(me=common.StrToInt(common.Trim(common.GROUP_CALLDIVERT)),l(),j$("#btn_back_settings").show(),j$("#app_name_settings").hide(),j$("#settings_page_title").html(j),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("settings_title"))):"submenu_general"===P?(me=common.StrToInt(common.Trim(common.GROUP_GENERAL)),l(),j$("#btn_back_settings").show(),j$("#app_name_settings").hide(),j$("#settings_page_title").html(j),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("settings_title"))):"submenu_profile"===P?(me=common.StrToInt(common.Trim(common.GROUP_PROFILE)),l(),j$("#btn_back_settings").show(),j$("#app_name_settings").hide(),j$("#settings_page_title").html(j),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("settings_title"))):"submenu_integrate"===P?(me=common.StrToInt(common.Trim(common.GROUP_INTEGRATE)),l(),j$("#btn_back_settings").show(),j$("#app_name_settings").hide(),j$("#settings_page_title").html(j),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("settings_title"))):"submenu_screenshare"===P?(me=common.StrToInt(common.Trim(common.GROUP_SCRSHARE)),l(),j$("#btn_back_settings").show(),j$("#app_name_settings").hide(),j$("#settings_page_title").html(j),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("settings_title"))):"submenu_advanced_artcl"===P&&(j$("#btn_back_settings").show(),j$("#app_name_settings").hide(),me=6,l())),"7"===k&&alert("not implemented yet"),"8"===k){if("audiodevices"===P&&common.AlertDialog(stringres.get("sett_display_name_audiodevices"),stringres.get("sett_comment_audiodevices")),"reset_settings"===P){var f='<div data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+N+'px;"><div data-role="header" data-theme="b"><a href="javascript:;" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+j+'</h1></div><div role="main" class="ui-content adialog_content"><span>'+stringres.get("reset_settings_msg")+'</span></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" id="adialog_positive" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_ok")+'</a><a href="javascript:;" id="adialog_negative" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back">'+stringres.get("btn_cancel")+"</a></div></div>",b=function(){};j$.mobile.activePage.append(f).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(e){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),j$("#adialog_positive").off("click"),j$("#adialog_negative").off("click"),b()}}),j$("#adialog_positive").on("click",function(e){"MSIE"===common.GetBrowser()&&e.preventDefault(),common.PutToDebugLog(5,"EVENT, settings onListItemClick Reset Settings ok"),u(j$.mobile.activePage.find(".messagePopup"));var t=common.GetParameter("username"),o=common.GetParameter("password"),n=common.GetParameter("serveraddress_orig"),i=common.GetParameter("serveraddress_user"),a=common.GetParameter("proxyaddress"),s=common.GetParameter("sipusername"),r=common.GetParameter("displayname"),c=common.GetParameter("email"),m=common.GetParameter("voicemailnum"),l=common.GetParameter("callforwardonbusy");for(var g in common.settmap)delete common.settmap[g];for(var g in common.settmap2)delete common.settmap2[g];common.HandleSettings("","",function(){}),common.SaveParameter("username",t),common.SaveParameter("password",o),common.SaveParameter("serveraddress_orig",n),common.SaveParameter("serveraddress_user",i),common.SaveParameter("proxyaddress",a),common.SaveParameter("sipusername",s),common.SaveParameter("displayname",r),common.SaveParameter("email",c),common.SaveParameter("voicemailnum",m),common.SaveParameter("callforwardonbusy",l),common.ShowToast(stringres.get("reset_settings_msg2"))}),j$("#adialog_negative").on("click",function(e){"MSIE"===common.GetBrowser()&&e.preventDefault(),u(j$.mobile.activePage.find(".messagePopup"))})}if("aec"===P){for(var ne="",ie="",ae="",se="",re="",ce="",le=E.split(","),i=0;i<le.length;i++)"-1"===le[i]&&(ne='checked="checked"'),"0"===le[i]&&(ie='checked="checked"'),"1"===le[i]&&(ae='checked="checked"'),"2"===le[i]&&(se='checked="checked"'),"3"===le[i]&&(re='checked="checked"'),"4"===le[i]&&(ce='checked="checked"');var f='<div id="settings_type_aec" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" data-dismissible="false" style="max-width:'+N+"px; min-width: "+Math.floor(.6*N)+'px;"><div data-role="header" data-theme="b"><h1 class="adialog_title">'+j+'</h1></div><div role="main" class="ui-content adialog_content_select"><fieldset id="settings_select_3" data-role="controlgroup"><input name="'+P+'" id="aec_auto" '+ne+' type="checkbox"><label for="aec_auto">'+stringres.get("aec_auto")+'</label><input name="'+P+'" id="aec_none" '+ie+' type="checkbox"><label for="aec_none">'+stringres.get("aec_none")+'</label><input name="'+P+'" id="aec_software" '+ae+' type="checkbox"><label for="aec_software">'+stringres.get("aec_software")+'</label><input name="'+P+'" id="aec_native" '+se+' type="checkbox"><label for="aec_native">'+stringres.get("aec_native")+'</label><input name="'+P+'" id="aec_fast" '+re+' type="checkbox"><label for="aec_fast">'+stringres.get("aec_fast")+'</label><input name="'+P+'" id="aec_decrease_volume" '+ce+' type="checkbox"><label for="aec_decrease_volume">'+stringres.get("aec_decrease_volume")+'</label></fieldset></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" style="width: 98%;" id="adialog_positive" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_ok")+"</a></div></div>",b=function(){};j$.mobile.activePage.append(f).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(e){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),j$("#adialog_positive").off("click"),b()}}),j$(":checkbox").on("change",function(e){var t=j$(this).attr("id");"aec_auto"===t&&j$("#"+t).prop("checked")&&(j$("#aec_none").prop("checked",!1).checkboxradio("refresh"),j$("#aec_software").prop("checked",!1).checkboxradio("refresh"),j$("#aec_native").prop("checked",!1).checkboxradio("refresh"),j$("#aec_fast").prop("checked",!1).checkboxradio("refresh"),j$("#aec_decrease_volume").prop("checked",!1).checkboxradio("refresh")),"aec_none"===t&&(j$("#"+t).prop("checked")?(j$("#aec_auto").prop("checked",!1).checkboxradio("refresh"),j$("#aec_software").prop("checked",!1).checkboxradio("refresh"),j$("#aec_native").prop("checked",!1).checkboxradio("refresh"),j$("#aec_fast").prop("checked",!1).checkboxradio("refresh"),j$("#aec_decrease_volume").prop("checked",!1).checkboxradio("refresh")):j$("#aec_auto").prop("checked",!0).checkboxradio("refresh")),"aec_software"===t&&(j$("#"+t).prop("checked")?(j$("#aec_auto").prop("checked",!1).checkboxradio("refresh"),j$("#aec_none").prop("checked",!1).checkboxradio("refresh")):!1===j$("#aec_native").prop("checked")&&!1===j$("#aec_fast").prop("checked")&&!1===j$("#aec_decrease_volume").prop("checked")&&j$("#aec_auto").prop("checked",!0).checkboxradio("refresh")),"aec_native"===t&&(j$("#"+t).prop("checked")?(j$("#aec_auto").prop("checked",!1).checkboxradio("refresh"),j$("#aec_none").prop("checked",!1).checkboxradio("refresh")):!1===j$("#aec_software").prop("checked")&&!1===j$("#aec_fast").prop("checked")&&!1===j$("#aec_decrease_volume").prop("checked")&&j$("#aec_auto").prop("checked",!0).checkboxradio("refresh")),"aec_fast"===t&&(j$("#"+t).prop("checked")?(j$("#aec_auto").prop("checked",!1).checkboxradio("refresh"),j$("#aec_none").prop("checked",!1).checkboxradio("refresh")):!1===j$("#aec_software").prop("checked")&&!1===j$("#aec_native").prop("checked")&&!1===j$("#aec_decrease_volume").prop("checked")&&j$("#aec_auto").prop("checked",!0).checkboxradio("refresh")),"aec_decrease_volume"===t&&(j$("#"+t).prop("checked")?(j$("#aec_auto").prop("checked",!1).checkboxradio("refresh"),j$("#aec_none").prop("checked",!1).checkboxradio("refresh")):!1===j$("#aec_software").prop("checked")&&!1===j$("#aec_native").prop("checked")&&!1===j$("#aec_fast").prop("checked")&&j$("#aec_auto").prop("checked",!0).checkboxradio("refresh"))}),j$("#adialog_positive").on("click",function(e){"MSIE"===common.GetBrowser()&&e.preventDefault(),common.PutToDebugLog(5,"EVENT, settings onListItemClick aec ok"),u(j$.mobile.activePage.find(".messagePopup")),E="",j$("#aec_auto").prop("checked")&&(E+="-1,"),j$("#aec_none").prop("checked")&&(E+="0,"),j$("#aec_software").prop("checked")&&(E+="1,"),j$("#aec_native").prop("checked")&&(E+="2,"),j$("#aec_fast").prop("checked")&&(E+="3,"),j$("#aec_decrease_volume").prop("checked")&&(E+="4,"),w[common.SETT_VALUE]=E,w[common.SETT_ISDEFAULT]="0",common.settmap[P]=w,common.settmap2[P]=w,_(P)})}if("serveraddress_user"===P){j=common.GetParameter("server_label"),2===common.GetParameterInt("brandid",-1)&&(y=stringres.get("sett_comment_serveraddress_user_gmsdialer")),(j.toLowerCase().indexOf("op code")>=0||j.toLowerCase().indexOf("operator code")>=0)&&(y=stringres.get("sett_comment_serveraddress_user_operator")),common.GetConfig("server_comment").length>1&&(y=common.GetConfig("server_comment"));var ue="",_e="",ve=common.GetParameter("displaytopdomainserveraddress")
;common.isNull(ve)&&(ve=""),ve.length>1&&(ue='<span id="setting_item_srvaddrpart">'+ve+"</span>",_e='data-wrapper-class="setting_item_input_class"');var f='<div id="settings_type_server" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+N+'px;"><div data-role="header" data-theme="b"><a href="javascript:;" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+j+'</h1></div><div role="main" class="ui-content adialog_content adialog_btn_nexttoinput"><span>'+y+'</span><div style="clear: both;">\x3c!--//--\x3e</div><input type="text" '+_e+' id="setting_item_input" name="setting_item" data-theme="a" autocapitalize="off"/>'+ue+'<button id="btn_srvhelp" class="btn_nexttoinput ui-btn ui-btn-corner-all ui-btn-b noshadow"><img src="'+common.GetElementSource()+'images/icon_help_mark.png"></button></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" id="adialog_positive" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_ok")+'</a><a href="javascript:;" id="adialog_negative" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back">'+stringres.get("btn_cancel")+"</a></div></div>",b=function(){};j$.mobile.activePage.append(f).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(e){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),j$("#adialog_positive").off("click"),j$("#adialog_negative").off("click"),j$("#btn_srvhelp").off("click"),b()}}),"true"===common.GetParameter("serverinputisupperserver")&&(common.GetParameter("autoprovisioning").length<1||"0"===common.GetParameter("autoprovisioning"))&&(E=common.GetParameter("upperserver"));var x=document.getElementById("setting_item_input");if(!common.isNull(E)&&E.length>0&&!common.isNull(x)){var he=E;ve.length>1&&(he=!common.isNull(he)&&he.length>0&&he.indexOf(ve)>=0?he.replace(ve,""):""),x.value=he}setTimeout(function(){common.isNull(x)||x.focus()},150),j$("#adialog_positive").on("click",function(e){"MSIE"===common.GetBrowser()&&e.preventDefault(),common.PutToDebugLog(5,"EVENT, settings onListItemClick serveraddress ok"),u(j$.mobile.activePage.find(".messagePopup"));var t="";if(common.isNull(x)||(t=x.value),!common.isNull(t)&&t.length>0){if(E=common.Trim(t),common.isNull(E)&&(E=""),E=common.NormalizeInput(E,0),ve.length>1&&(E+=ve),"true"===common.GetParameter("serverinputisupperserver"))return"1"===common.GetParameter("autoprovisioning")||"2"===common.GetParameter("autoprovisioning")?(common.SaveParameter("serveraddress_user",E),common.SaveParameter("upperserver",E)):common.SaveParameter("upperserver",E),void _(P);if("1"===common.GetParameter("autoprovisioning")||"2"===common.GetParameter("autoprovisioning")){if(global.autoServerDeployVersion&&E.indexOf(".")>0)return void common.AlertWindow(stringres.get("warning"),stringres.get("warning_msg_2"));E=E.toLowerCase(),(E.indexOf(".")>0||"mizu"===E.toLowerCase())&&(common.SaveParameter("serveraddress_orig",E),common.SaveParameter("upperserver",""))}else common.SaveParameter("serveraddress_orig",E),common.SaveParameter("upperserver","");w[common.SETT_VALUE]=E,w[common.SETT_ISDEFAULT]="0",common.settmap[P]=w,common.settmap2[P]=w,_(P)}}),j$("#adialog_negative").on("click",function(e){"MSIE"===common.GetBrowser()&&e.preventDefault(),u(j$.mobile.activePage.find(".messagePopup"))}),j$("#btn_srvhelp").on("click",function(e){"MSIE"===common.GetBrowser()&&e.preventDefault(),j$.mobile.activePage.find(".messagePopup").popup("close");var t='<br /><a href="http://www.mizu-voip.com/VoIPServiceProviders.aspx" onclick="common_public.OpenLinkInExternalBrowser(\'http://www.mizu-voip.com/VoIPServiceProviders.aspx\')" id="btn_srvhelp" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b " target="_blank">'+stringres.get("help_provider")+"</a>";common.AlertDialog(stringres.get("help"),stringres.get("srvaddr_help")+t)})}}}catch(fe){common.PutToDebugLogException(2,"_settings: OnListItemClick",fe)}}function p(){}function d(){try{me=common.StrToInt(common.Trim(common.GROUP_SIP)),l(),j$("#btn_back_settings").show(),j$("#app_name_settings").hide(),j$("#settings_page_title").html(stringres.get("sett_display_name_submenu_sipsettings")),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("settings_title"))}catch(e){common.PutToDebugLogException(2,"_settings: SubmenuSipSettings",e)}}function u(e){try{if(common.isNull(e)||common.isNull(e.popup))return;"MSIE"===common.GetBrowser()?e.popup("close"):"Firefox"===common.GetBrowser()&&setTimeout(function(){try{e.popup("close")}catch(t){}},200)}catch(t){common.PutToDebugLogException(2,"_settings: ManuallyClosePopup",t)}}function _(e){try{if(common.isNull(e)||e.length<1)return void common.PutToDebugLog(2,"WARNING, _settings: ShowSettValue settname is NULL");var t=common.settmap2[e];if(common.isNull(t))return;var o=t[common.SETT_ISDEFAULT];if("serveraddress_user"===e&&"true"===common.GetParameter("serverinputisupperserver"))return void(document.getElementById("sett_comment_"+e).innerHTML=v(e)+" "+h(e));if("1"===o)return;var n=document.getElementById("sett_comment_"+e);if(common.isNull(n))return void common.PutToDebugLog(2,"WARNING, _settings: ShowSettValue commentfield is NULL");n.innerHTML=v(e)+" "+h(e)}catch(i){common.PutToDebugLogException(2,"_settings: ShowSettValue",i)}}function v(e){var t="";try{if(common.isNull(e)||e.length<1)return common.PutToDebugLog(2,"WARNING, _settings: GetSettComment settname is NULL"),"";var o=common.settmap2[e];if(common.isNull(o))return"";var n=stringres.get("sett_comment_"+e),i=stringres.get("sett_comment_short_"+e);t=!common.isNull(i)&&i.length>0?i:n}catch(a){common.PutToDebugLogException(2,"_settings: GetSettComment",a)}return t}function h(e){var t="";try{if(common.isNull(e)||e.length<1)return common.PutToDebugLog(2,"WARNING, _settings: GetSettComment settname is NULL"),"";var o=common.settmap2[e];if(common.isNull(o))return"";var n=o[common.SETT_TYPE],i=common.GetParameter(e);if("password"===e&&i.length>0)t="*****";else if("loglevel"===e)t="1"===i?stringres.get("sett_disabled"):stringres.get("sett_enabled");else if("0"===n)t="true"===i||"2"===i?stringres.get("sett_enabled"):stringres.get("sett_disabled");else if("1"===n)t=i,"ringtimeout"!==e&&"calltimeout"!==e||(t=t.substring(0,t.length-3));else if("2"===n){var a=o[common.SETT_ALLNAMES].split(","),s=o[common.SETT_ALLVALUES].split(",");if(common.isNull(a)||a.length<1||common.isNull(s)||s.length<1)return"";for(var r=0;r<s.length;r++)if(s[r]===i){t=a[r];break}}else if("3"===n){var a=o[common.SETT_ALLNAMES].split(","),s=o[common.SETT_ALLVALUES].split(","),c=[];if(i.indexOf(",")>0?c=i.split(","):c[0]=i,common.isNull(a)||a.length<1||common.isNull(s)||s.length<1||common.isNull(c))return"";for(var m=0;m<c.length;m++)for(var r=0;r<s.length;r++)s[r]===c[m]&&(t.length>0&&(t+=", "),t+=a[r])}else if("4"===n)t=i+"%";else if("5"===n||"6"===n||"7"===n)t="";else if("8"===n)if("aec"===e){var a=o[common.SETT_ALLNAMES].split(","),s=o[common.SETT_ALLVALUES].split(","),c=[];if(i.indexOf(",")>0?c=i.split(","):c[0]=i,common.isNull(a)||a.length<1||common.isNull(s)||s.length<1||common.isNull(c))return"";for(var m=0;m<c.length;m++)for(var r=0;r<s.length;r++)s[r]===c[m]&&(t.length>0&&(t+=", "),t+=a[r])}else"serveraddress_user"===e&&(t="true"===common.GetParameter("serverinputisupperserver")&&(common.GetParameter("autoprovisioning").length<1||"0"===common.GetParameter("autoprovisioning"))?common.GetParameter("upperserver"):i);t=!common.isNull(t)&&t.length>0?"("+t+")":""}catch(l){common.PutToDebugLogException(2,"_settings: GetSettFormattedValue",l)}return t}function f(e){try{if(M)return void D();me===common.StrToInt(common.GROUP_SIP)||me===common.StrToInt(common.GROUP_MEDIA)||me===common.StrToInt(common.GROUP_CALLDIVERT)||me===common.StrToInt(common.GROUP_GENERAL)||me===common.StrToInt(common.GROUP_PROFILE)?(me=common.StrToInt(common.GROUP_MAIN),l(),j$("#settings_page_title").html(stringres.get("settings_title")),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("settings_login"))):me===common.StrToInt(common.GROUP_LOGIN)?(me=20,w(!0)):me===common.StrToInt(common.GROUP_MAIN)?(me=common.StrToInt(common.GROUP_LOGIN),M&&D(),"app"===U?j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("btn_cancel")):(j$("#btn_back_settings").hide(),j$("#app_name_settings").show()),b()&&(j$("#settings_list").hide(),j$("#loginpage_container").show()),n(),l(),j$("#settings_page_title").html(stringres.get("settings_login"))):me===common.StrToInt(common.GROUP_INTEGRATE)?(me=common.StrToInt(common.GROUP_GENERAL),l(),j$("#settings_page_title").html(stringres.get("sett_display_name_submenu_general")),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("settings_title"))):me===common.StrToInt(common.GROUP_VIDEO)?(me=common.StrToInt(common.GROUP_MEDIA),l(),j$("#settings_page_title").html(stringres.get("sett_display_name_submenu_media")),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("settings_title"))):me===common.StrToInt(common.GROUP_SCRSHARE)?(me=common.StrToInt(common.GROUP_MEDIA),l(),j$("#settings_page_title").html(stringres.get("sett_display_name_submenu_media")),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("settings_title"))):6===me&&(me=common.StrToInt(common.GROUP_MAIN),l(),j$("#settings_page_title").html(stringres.get("settings_title")))}catch(t){common.PutToDebugLogException(2,"_settings: BackOnClick",t)}}function b(){try{var e=common.GetConfigInt("useloginpage",10);return e>8&&(e=common.GetParameterInt("useloginpage",-1)),common.isNull(webphone_api.parameters.useloginpage)||(e=webphone_api.parameters.useloginpage),ue=common.GetConfigInt("featureset",10),ue>9&&(ue=common.GetParameterInt("featureset",3)),-1===e?ue<2:0!==e&&(1!==e||"app"!==U)}catch(t){common.PutToDebugLogException(2,"_settings: ShowLoginPage",t)}return!1}function P(e){try{var t="",o="",n="";if(common.HandleCallerID(),V.toLowerCase()!==common.GetParameter("serveraddress_user").toLowerCase()&&common.SaveParameter("lastautoprov",""),common.RequestUserServerInput()&&"true"===common.GetParameter("serverinputisupperserver")){var i=common.GetParameter("upperserver"),a=common.GetParameter("serveraddress_user");if((i.length<0||a.indexOf(".")>0)&&common.ShowServerInput()&&(common.SaveParameter("iswebrtcuppersrvfromuser","true"),common.SaveParameter("upperserver",a)),common.GetParameter("autoprovisioning").length<1||"0"===common.GetParameter("autoprovisioning")){if(t=common.GetParameter("upperserver"),o=stringres.get("sett_display_name_serveraddress_user"),n=stringres.get("sett_comment_serveraddress_user"),common.isNull(t)||t.length<=0)return void common.ShowToast(stringres.get("please_enter")+" "+n)}else t=common.GetParameter("serveraddress_user"),o=stringres.get("sett_display_name_serveraddress_user"),n=stringres.get("sett_comment_serveraddress_user"),"mizu"===t.toLowerCase()&&(t="voip.mizu-voip.com",common.SaveParameter("serveraddress_user",t));if(t=common.GetSipusername(),o=stringres.get("sett_display_name_sipusername"),n=stringres.get("sett_comment_sipusername"),common.isNull(t)||t.length<=0)return void common.ShowToast(stringres.get("username_warning"));if(!0===common.GetConfigBool("mizuserveronly",!1)&&t.length<3)return common.PutToDebugLog("WARNING, "+stringres.get("username_warning2")+"_1"),void common.ShowToast(stringres.get("username_warning2"));if(t=common.GetParameter("password"),o=stringres.get("sett_display_name_password"),n=stringres.get("sett_comment_password"),common.isNull(t)||t.length<=0)return void common.ShowToast(o,stringres.get("please_enter")+" "+n);if(!0===common.GetConfigBool("mizuserveronly",!1)&&t.length<3)return common.PutToDebugLog(2,"WARNING, "+stringres.get("password_warning2")+"_1"),void common.ShowToast(stringres.get("password_warning2"))}else if(!0!==common.GetParameterBool("customizedversion",!0)){if(t=common.GetSipusername(),o=stringres.get("sett_display_name_sipusername"),n=stringres.get("sett_comment_sipusername"),common.isNull(t)||t.length<=0)return void common.ShowToast(stringres.get("username_warning"));if(!0===common.GetConfigBool("mizuserveronly",!1)==!0&&t.length<3)return common.PutToDebugLog("WARNING, "+stringres.get("username_warning2")+"_2"),void common.ShowToast(stringres.get("username_warning2"));t=common.GetParameter("serveraddress_user"),o=stringres.get("sett_display_name_serveraddress_user"),n=stringres.get("sett_comment_serveraddress_user"),"mizu"===t.toLowerCase()&&(t="voip.mizu-voip.com",common.SaveParameter("serveraddress_user",t))}else{if(t=common.GetSipusername(),o=stringres.get("sett_display_name_sipusername"),n=stringres.get("sett_comment_sipusername"),common.isNull(t)||t.length<=0)return void common.ShowToast(stringres.get("username_warning"));if(!0===common.GetConfigBool("mizuserveronly",!1)&&t.length<3)return common.PutToDebugLog("WARNING, "+stringres.get("username_warning2")+"_3"),void common.ShowToast(stringres.get("username_warning2"));if(t=common.GetParameter("password"),o=stringres.get("sett_display_name_password"),n=stringres.get("sett_comment_password"),common.isNull(t)||t.length<=0)return void common.ShowToast(stringres.get("please_enter")+" "+n);if(!0===common.GetConfigBool("mizuserveronly",!1)&&t.length<3)return common.PutToDebugLog(2,"WARNING, "+stringres.get("password_warning2")+"_2"),void common.ShowToast(stringres.get("password_warning2"))}if(setTimeout(function(){if(common.IsWindowsSoftphone()&&!1===common.ParameterIsDefault("startwithos")&&!1===common.GetParameterBool("startwithos_was_sent",!0)){var e=common.AddJscommport(global.WIN_SOFTPHONE_URL)+"?extcmd_startwithos="+common.GetParameter("startwithos");common.WinSoftphoneHttpReq(e,"GET","",function(e){common.PutToDebugLog(2,"EVENT, _settings: startwithos response: "+e)}),common.SaveParameter("startwithos_was_sent","true")}},5e3),j$("#settings_page_title").html(stringres.get("loading")),common.PutToDebugLogSpecial(1,"EVENT, _settings: SaveSettings set Loading... page title",!1,""),!1===W){var s=[],r="Account"+common.GetSipusername(),c=common.Md5Hash(r+common.GetParameter("serveraddress_user")+common.GetParameter("sipusername")+global.SALT+common.GetParameter("password")+common.GetLocationPathName()),m=common.GetConfig("brandid");(common.isNull(m)||m.length<1||"-1"==m)&&(m=common.GetBrandName().toLowerCase()),c+=m,s[common.AC_NAME]=r,s[common.AC_SIPUSERNAME]=common.GetSipusername(),s[common.AC_SETTFILE]=c,s[common.AC_CHFILE]=c+"_ch",s[common.AC_ISACTIVE]="true",global.aclist.push(s)}common.SaveSettingsFile(common.GetActiveAccSettingsFilename(),function(t){if(w(e),window.location.href.indexOf("isdemopage=true")>0)try{var o="";o=common.GetParameter("sipusername"),o.length>0&&webphone_api.setparameter("sipusername",o),o=common.GetParameter("username"),o.length>0&&webphone_api.setparameter("username",o),o=common.GetParameter("password"),o.length>0&&webphone_api.setparameter("password",o),o=common.GetParameter("sippassword"),o.length>0&&webphone_api.setparameter("sippassword",o),o=common.GetParameter("serveraddress_user"),o.length>0&&webphone_api.setparameter("serveraddress_user",o),o=common.GetParameter("serveraddress_orig"),o.length>0&&webphone_api.setparameter("serveraddress_orig",o),o=common.GetParameter("serveraddress"),o.length>0&&webphone_api.setparameter("serveraddress",o),o=common.GetParameter("upperserver"),o.length>0&&webphone_api.setparameter("upperserver",o),o=common.GetParameter("callto"),o.length>0&&webphone_api.setparameter("callto",o),o=common.GetParameter("destination"),o.length>0&&webphone_api.setparameter("destination",o)}catch(n){common.PutToDebugLogException(2,"_settings: SaveSettings inner1",n)}setTimeout(function(){common.SaveAccountsFile(function(e){e?common.PutToDebugLog(3,"EVENT, _settings: SaveSettings Accounts file saved successfully"):common.PutToDebugLog(2,"ERROR, _settings: SaveSettings Accounts file save failed")})},200)})}catch(l){common.PutToDebugLogException(2,"_settings: SaveSettings",l)}}function w(e){try{E(e)}catch(t){common.PutToDebugLogException(2,"_settings: BeforeStart",t)}}function E(e){try{j$.mobile.changePage("#page_dialpad",{transition:"pop",role:"page"});var t=500;common.IsWindowsSoftphone()&&(t=100),setTimeout(function(){common.IsWindowsSoftphone()&&(webphone_public.webphone_started=!1),!0===e&&(common.PutToDebugLog(2,"EVENT, mlogic API_Start _settings StartPhone"),webphone_api.start(common.GetSipusername(),common.GetParameter("password")))},t),setTimeout(function(){!0===common.UsePresence2()&&common.SetSelectedPresence("Offline",!1)},1e3)}catch(o){common.PutToDebugLogException(2,"_settings: StartPhone",o)}}function k(){try{var e=common.AddJscommport(global.WIN_SOFTPHONE_URL)+"?extcmd_qrcode";common.WinSoftphoneHttpReq(e,"GET","",function(e){common.PutToDebugLog(2,"EVENT, _settings: extcmd_qrcode response: "+e)})}catch(t){common.PutToDebugLogException(2,"_settings: QRcodeLogin",t)}}function S(){try{j$.mobile.changePage("#page_newuser",{transition:"pop",role:"page"})}catch(e){common.PutToDebugLogException(2,"_settings: OnNewUserClicked",e)}}function T(){try{50===common.GetConfigInt("brandid",-1)&&j$.mobile.changePage("#page_newuser",{transition:"pop",role:"page"})}catch(e){common.PutToDebugLogException(2,"_settings: CustomBtn",e)}}function j(e){try{if(common.GetParameter("devicetype")===common.DEVICE_WIN_SOFTPHONE()&&j$("#btn_settings_menu").removeAttr("data-transition"),common.isNull(e)||e.lenght<1)return void common.PutToDebugLog(2,"ERROR, _settings: CreateOptionsMenu menuid null");if(j$(e).length<=0)return void common.PutToDebugLog(2,"ERROR, _settings: CreateOptionsMenu can't get reference to Menu");"#"!==e.charAt(0)&&(e="#"+e),j$(e).html("");var t="";t=R?stringres.get("menu_switchtoadvanced"):stringres.get("menu_switchtobasic");var o="";o=M?stringres.get("hide_search"):stringres.get("show_search"),me===common.StrToInt(common.GROUP_LOGIN)?j$(e).append('<li id="'+ve+'"><a data-rel="back">'+stringres.get("menu_showsettings")+"</a></li>").listview("refresh"):(j$(e).append('<li id="'+_e+'"><a data-rel="back">'+t+"</a></li>").listview("refresh"),j$(e).append('<li id="'+he+'"><a data-rel="back">'+o+"</a></li>").listview("refresh")),j$(e).append('<li id="'+Ee+'"><a data-rel="back">'+stringres.get("menu_speedtest")+"</a></li>").listview("refresh"),j$("#"+Ee).attr("title",stringres.get("hint_speedtest"));var n=stringres.get("menu_help")+"...";return 60===common.GetConfigInt("brandid",-1)&&("app"===U&&j$(e).append('<li id="'+we+'"><a data-rel="back">'+stringres.get("logview_title")+"</a></li>").listview("refresh"),n=stringres.get("help_about")),j$(e).append('<li id="'+fe+'"><a data-rel="back">'+n+"</a></li>").listview("refresh"),common.GetParameter("devicetype")===common.DEVICE_WIN_SOFTPHONE()&&j$(e).append('<li id="'+be+'"><a data-rel="back">'+stringres.get("menu_exit")+"</a></li>").listview("refresh"),!0}catch(i){common.PutToDebugLogException(2,"_settings: CreateOptionsMenu",i)}return!1}function y(e){try{if(common.isNull(e)||e.length<1)return;if(e===Ee){var t="https://sourceforge.net/speedtest/";!0===common.IsWindowsSoftphone()?common_public.OpenLinkInExternalBrowser(t):window.open(t)}j$("#settings_menu").on("popupafterclose",function(t){switch(j$("#settings_menu").off("popupafterclose"),e){case _e:I();break;case ve:$();break;case he:D();break;case fe:common.HelpWindow("settings");break;case be:common.Exit();break;case Pe:common.UpgradeToProVersion();break;case we:j$.mobile.changePage("#page_logview",{transition:"pop",role:"page"})}})}catch(o){common.PutToDebugLogException(2,"_settings: MenuItemSelected",o)}}function $(){try{j$("#loginpage_container").is(":visible")&&(j$("#loginpage_container").hide(),j$("#settings_list").show()),me=common.StrToInt(common.GROUP_MAIN),j$("#btn_back_settings").show(),j$("#app_name_settings").hide(),j$("#settings_page_title").html(stringres.get("settings_title")),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("settings_login")),l()}catch(e){common.PutToDebugLogException(2,"_settings: ShowSettings",e)}}function G(){try{B=1,j$("#loginpage_container").is(":visible")&&(j$("#loginpage_container").hide(),j$("#settings_list").show()),me=common.StrToInt(common.GROUP_MAIN),j$("#btn_back_settings").show(),j$("#app_name_settings").hide(),j$("#settings_page_title").html(stringres.get("settings_title")),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("settings_login")),l()}catch(e){common.PutToDebugLogException(2,"_settings: ShowLoginSettings",e)}}function I(){try{R?L():(R=!0,me===common.StrToInt(common.GROUP_MEDIA)&&(me=common.StrToInt(common.GROUP_MAIN)),l(),common.SaveParameter("settlevelbasic","true"))}catch(e){common.PutToDebugLogException(2,"_settings: SwitchBetweenBasicAdvanced",e)}}function N(){try{if(R=!1,me===common.StrToInt(common.GROUP_LOGIN))return $(),void common.SaveParameter("settlevelbasic","false");l(),common.SaveParameter("settlevelbasic","false")}catch(e){common.PutToDebugLogException(2,"_settings: ShowAdvancedSettings",e)}}function L(){try{if(!0===ke)return void N();var e=common.GetConfig("advancedsettpwd");if((common.isNull(e)||e.length<1)&&(e=common.GetParameter2("advancedsettpwd")),common.isNull(e)||e.length<1)return ke=!0,void N();e=common.Trim(e),0===e.indexOf("encrypted__3__")&&(e=common.StrDc(e,common.GetPassphrase()));var t=common.GetDeviceWidth();t=!common.isNull(t)&&common.IsNumber(t)&&t>100?Math.floor(t/1.2):220;var o=stringres.get("unlockadvancedsett_msg")+":",n='<div id="advancedsett_popup" data-role="popup" class="ui-content messagePopup" data-overlay-theme="a" data-theme="a" style="max-width:'+t+'px;"><div data-role="header" data-theme="b"><a href="javascript:;" data-role="button" data-icon="delete" data-iconpos="notext" class="ui-btn-right closePopup">Close</a><h1 class="adialog_title">'+stringres.get("unlockadvancedsett_title")+'</h1></div><div role="main" class="ui-content adialog_content"><span>'+o+'</span><div style="clear: both;">\x3c!--//--\x3e</div><input type="text" id="advancedsett_input" name="setting_item" data-theme="a" autocapitalize="off"/></div><div data-role="footer" data-theme="b" class="adialog_footer"><a href="javascript:;" id="adialog_positive" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back" data-transition="flow">'+stringres.get("btn_ok")+'</a><a href="javascript:;" id="adialog_negative" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b adialog_2button" data-rel="back">'+stringres.get("btn_cancel")+"</a></div></div>";j$.mobile.activePage.append(n).trigger("create"),j$.mobile.activePage.find(".closePopup").bind("tap",function(e){j$.mobile.activePage.find(".messagePopup").popup("close")}),j$.mobile.activePage.find(".messagePopup").popup().popup("open").bind({popupafterclose:function(){j$(this).unbind("popupafterclose").remove(),j$("#adialog_positive").off("click"),j$("#adialog_negative").off("click")}});var i=document.getElementById("advancedsett_input");return common.isNull(i)||i.focus(),j$("#adialog_positive").on("click",function(t){common.PutToDebugLog(5,"EVENT, _settings AdvancedSettProtected ok onclick");var o=common.Trim(i.value);j$("#advancedsett_popup").on("popupafterclose",function(t){!common.isNull(o)&&o.length>0&&o===e?(common.PutToDebugLog(5,"EVENT, _settings AdvancedSettProtected ok onclick password match"),ke=!0,N()):(common.PutToDebugLog(5,"EVENT, _settings AdvancedSettProtected ok onclick password NOT match: "+o),common.ShowToast(stringres.get("err_msg_2")))})}),void j$("#adialog_negative").on("click",function(e){})}catch(a){common.PutToDebugLogException(2,"_settings: AdvancedSettProtected",a)}N()}function D(){try{M?(common.isNull(Se)||Se.length<2?(j$("#btn_back_settings").hide(),j$("#app_name_settings").show()):(j$("#btn_back_settings").html(Se),Se=""),M=!1,j$("#settings_list").prev("form.ui-filterable").hide(),l(),n()):(j$("#btn_back_settings").is(":visible")&&(Se=j$("#btn_back_settings").html()),j$("#btn_back_settings").show(),j$("#app_name_settings").hide(),j$("#btn_back_settings").html("<b>&LT;</b>&nbsp;"+stringres.get("hide_search")),M=!0,j$("#settings_list").prev("form.ui-filterable").show(),l(),n())}catch(e){common.PutToDebugLogException(2,"_settings: ShowHideSearch",e)}}function x(){try{var e=webphone_api.parameters.username,t=webphone_api.parameters.sipusername,o=common.GetConfig("username"),n=common.GetConfig("sipusername");if(!common.isNull(e)&&e.length>0&&"USERNAME"!==e&&"SIPUSERNAME"!==e||!common.isNull(t)&&t.length>0&&"USERNAME"!==t&&"SIPUSERNAME"!==t||!common.isNull(o)&&o.length>0&&"USERNAME"!==o&&"SIPUSERNAME"!==o||!common.isNull(n)&&n.length>0&&"USERNAME"!==n&&"SIPUSERNAME"!==n)return!0}catch(i){common.PutToDebugLogException(2,"_settings: IsUsernameFixed",i)}return!1}function C(){try{var e=webphone_api.parameters.password,t=common.GetConfig("password");if(!common.isNull(e)&&e.length>0&&"PASSWORD"!==e&&"SIPPASSWORD"!==e&&"SIPASSWORD"!==e||!common.isNull(t)&&t.length>0&&"PASSWORD"!==t&&"SIPPASSWORD"!==t&&"SIPASSWORD"!==t)return!0}catch(o){common.PutToDebugLogException(2,"_settings: IsPasswordFixed",o)}return!1}function O(e){try{common.PutToDebugLog(4,"EVENT, _settings: onStop"),global.isSettingsStarted=!1,U="",R=!0,q=!1,le=!1,Q="",global.favafone_autologin=!1,M&&D()}catch(t){common.PutToDebugLogException(2,"_settings: onStop",t)}}function A(e){}var R=!0,U="",M=!1,B=0,V="",H="",W=!1,F=null,K=0,z=!1,q=!1,Y=null,J=0,Q="",X="androidspeaker,";"Android"!==common.GetOs()&&(X="");var Z="accounts,";common.Glv()<2&&(Z="");var ee="";ee="usetunneling,"
;var te="serveraddress_user,sipusername,password,submenu_sipsettings,advancedloginsettings2,submenu_media,submenu_calldivert,submenu_general,submenu_profile,theme,language,"+Z+"incomingcallpopup,sendchatonenter,voicerecording,keeprecfiles,proxyaddress,realm,username,profilepicture,displayname,email,presencestatus,share_location,profilestatustext,hidemyidentity,"+ee+"transport,use_fast_ice,use_stun,use_rport,register,registerinterval,keepaliveival,keepalive,natopenpackets,ringtimeout,calltimeout,enableblf,dtmfmode,chatsms,prack,earlymedia,sendrtponmuted,defmute,changesptoring,localip,signalingport,rtpport,capabilityrequest,customsipheader,normalizenumber,techprefix,filters,callforwardonbusy,callforwardonnoanswer,callforwardonnoanswertimeout,callforwardalways,calltransferalways,transfwithreplace,autoignore,autoaccept,dropsameoldcall,voicemailnum,callbacknumber,blacklist,transfertype,conferencetype,automute,autohold,holdtype,dialerintegration,integrateifwifionly,nativefilterallow,nativefilterblock,audiodevices,displayvolumecontrols,displayaudiodevice,savetocontacts,telsearchkey,extraoption,enablepush,reset_settings,loglevel,loglevel_dbg,playring,codec,alwaysallowlowcodec,icetimeout,audio_bandwidth,video,video_bandwidth,video_width,video_height,cfgvideo,video_profile,videocodec,"+X+"video_fps,setfinalcodec,aec,denoise,agc,plc,silencesupress,hardwaremedia,volumein,volumeout,mediaencryption,setqos,codecframecount,doublesendrtp,jittersize,audiobufferlength,speakermode",oe="serveraddress_user,proxyaddress,transport,displayname,username,sipusername,password,realm,settobasefunctionality,accounts,operation_mode,fine_tune,submenu_general,submenu_sipsettings,submenu_media,submenu_calldivert,submenu_profile,usetunneling,autoanswer_forward,submenu_integrate,hidemyidentity,use_fast_ice,use_stun,use_rport,register,registerinterval,acceptsrvexpire,enablepresence,enableblf,keepalive,natopenpackets,ringtimeout,calltimeout,dtmfmode,chatsms,offlinechat,prack,sendearlymedia,sendrtponmuted,defmute,changesptoring,signalingport,rtpport,capabilityrequest,customsipheader,checksrvrecords,devtest,filters,numrewriterulesadv,techprefix,callforwardonbusy,rejectonvoipbusy,rejectonphonebusy,rejectphoneonvoipbusy,voicemail,callback_accessnumber,callback_mode,accessnumber,accessnumbercalltype,transfertype,transfwithreplace,automute,autohold,holdtypeonhold,enabledirectcalls,normalizenumber,ringincall,beeponconnect,vibrate,keypadfeedback,cpualwayspartiallock,forcewifi,wifionly,keepdeviceawakeincall,unlockphone,proximitysensor,dialerintegration,ringtone,theme,profilepicture,email,info,presencestatus,share_location,integrateifwifionly,nativefilterallow,nativefilterblock,displaynotification,screenrotation,savetocontacts,extraoption,voicerecording,keepcallhistory,sendchatonenter,editbeforecall,recentcontacts,removefromtask,log,loglevel,playring,cfgvideo,callbackonincomingvideo,video_bandwidth,androidspeaker,video_width,video_height,use_h263,use_h264,use_vp8,use_vp9,cfgcpuspeed,cfgnetworkspeed,submenu_video,codec,prefcodec,alwaysallowlowcodec,setfinalcodec,disablewbforpstn,aec_orig,denoise_orig,agc_orig,plc_orig,silencesupress,hardwaremedia,volumein,volumeout,mediaencryption,setqos,codecframecount,doublesendrtp,jittersize,audiobufferlength,speakerphoneoutput,audiorecorder,audioplayer,speakerphoneplayer,incomingcallalert,autousebluetooth,speakermode,focusaudio,useroutingapi,scheduledwakeup,autorestart,runservice,enablefcm,backexit,killonexit,reset_settings",ne="serveraddress_user,sipusername,password,submenu_sipsettings,advancedloginsettings2,submenu_media,submenu_calldivert,submenu_general,submenu_profile,theme,language,"+Z+"incomingcallpopup,sendchatonenter,voicerecording,keeprecfiles,proxyaddress,realm,username,profilepicture,displayname,email,presencestatus,share_location,profilestatustext,hidemyidentity,"+ee+"ringtimeout,calltimeout,enableblf,dtmfmode,chatsms,earlymedia,defmute,customsipheader,normalizenumber,techprefix,filters,voicemailnum,callbacknumber,callforwardonbusy,callforwardonnoanswer,callforwardonnoanswertimeout,callforwardalways,calltransferalways,transfwithreplace,autoignore,autoaccept,dropsameoldcall,blacklist,transfertype,conferencetype,holdtype,autohold,dialerintegration,integrateifwifionly,nativefilterallow,nativefilterblock,audiodevices,displayvolumecontrols,displayaudiodevice,savetocontacts,telsearchkey,extraoption,enablepush,reset_settings,loglevel,loglevel_dbg,codec,alwaysallowlowcodec,icetimeout,audio_bandwidth,video,video_bandwidth,video_width,video_height,cfgvideo,video_profile,videocodec,"+X+"video_fps,aec,agc,volumein,volumeout",ie="serveraddress_user,sipusername,password,username,displayname,email,hidemyidentity,chatsms,voicemailnum,callbacknumber,loglevel",ae="hidemyidentity,realm,use_fast_ice,use_stun,use_rport,register,registerinterval,keepaliveival,keepalive,natopenpackets,prack,capabilityrequest,setfinalcodec",oe="serveraddress_user,proxyaddress,transport,displayname,username,sipusername,password,realm,settobasefunctionality,accounts,operation_mode,fine_tune,submenu_general,submenu_sipsettings,submenu_media,submenu_calldivert,submenu_profile,usetunneling,autoanswer_forward,submenu_integrate,hidemyidentity,use_fast_ice,use_stun,use_rport,register,registerinterval,acceptsrvexpire,enablepresence,enableblf,keepalive,natopenpackets,ringtimeout,calltimeout,dtmfmode,chatsms,offlinechat,prack,sendearlymedia,sendrtponmuted,defmute,changesptoring,signalingport,rtpport,capabilityrequest,customsipheader,checksrvrecords,devtest,filters,numrewriterulesadv,techprefix,callforwardonbusy,rejectonvoipbusy,rejectonphonebusy,rejectphoneonvoipbusy,voicemail,callback_accessnumber,callback_mode,accessnumber,accessnumbercalltype,transfertype,transfwithreplace,automute,autohold,holdtypeonhold,enabledirectcalls,normalizenumber,ringincall,beeponconnect,vibrate,keypadfeedback,cpualwayspartiallock,forcewifi,wifionly,keepdeviceawakeincall,unlockphone,proximitysensor,dialerintegration,ringtone,theme,profilepicture,email,info,presencestatus,share_location,integrateifwifionly,nativefilterallow,nativefilterblock,displaynotification,screenrotation,savetocontacts,extraoption,voicerecording,keepcallhistory,sendchatonenter,editbeforecall,recentcontacts,removefromtask,log,loglevel,playring,cfgvideo,callbackonincomingvideo,video_bandwidth,androidspeaker,video_width,video_height,use_h263,use_h264,use_vp8,use_vp9,cfgcpuspeed,cfgnetworkspeed,submenu_video,codec,prefcodec,alwaysallowlowcodec,setfinalcodec,disablewbforpstn,aec_orig,denoise_orig,agc_orig,plc_orig,silencesupress,hardwaremedia,volumein,volumeout,mediaencryption,setqos,codecframecount,doublesendrtp,jittersize,audiobufferlength,speakerphoneoutput,audiorecorder,audioplayer,speakerphoneplayer,incomingcallalert,autousebluetooth,speakermode,focusaudio,useroutingapi,scheduledwakeup,autorestart,runservice,enablefcm,backexit,killonexit,reset_settings",se="serveraddress_user,sipusername,password,submenu_sipsettings,advancedloginsettings2,submenu_media,submenu_calldivert,submenu_general,submenu_profile,theme,language,startwithos,"+Z+"voicerecording,keeprecfiles,proxyaddress,realm,username,profilepicture,displayname,email,presencestatus,share_location,profilestatustext,flash,beeponincoming,sendchatonenter,importonlywithnum,hidemyidentity,"+ee+"transport,use_fast_ice,use_stun,use_rport,register,registerinterval,keepaliveival,keepalive,natopenpackets,ringtimeout,calltimeout,enableblf,dtmfmode,chatsms,prack,earlymedia,sendrtponmuted,defmute,changesptoring,localip,signalingport,rtpport,capabilityrequest,customsipheader,normalizenumber,techprefix,filters,callforwardonbusy,callforwardonnoanswer,callforwardonnoanswertimeout,callforwardalways,calltransferalways,transfwithreplace,autoignore,autoaccept,dropsameoldcall,rejectonvoipbusy,voicemailnum,callbacknumber,blacklist,transfertype,conferencetype,automute,autohold,holdtype,dialerintegration,integrateifwifionly,nativefilterallow,nativefilterblock,audiodevices,displayvolumecontrols,displayaudiodevice,savetocontacts,telsearchkey,extraoption,enablepush,reset_settings,loglevel,loglevel_dbg,playring,video,video_bandwidth,video_width,video_height,cfgvideo,videomode,video_profile,videocodec,submenu_screenshare,sscontrol,ssscroll,sstop,ssquality,video_fps,codec,setfinalcodec,alwaysallowlowcodec,aec,denoise,agc,plc,silencesupress,hardwaremedia,volumein,volumeout,mediaencryption,setqos,codecframecount,doublesendrtp,jittersize,audiobufferlength,speakermode",re="settobasefunctionality,theme,username,displayname,"+ee+"transport,proxyaddress,register,ringtone,voicerecording,startonboot,dialerintegration,integrateifwifionly,nativefilterallow,nativefilterblock,cpualwayspartiallock,forcewifi,email,loglevel,startwithos",ce="settobasefunctionality,theme,displayname,ringtone,voicerecording,startonboot,dialerintegration,integrateifwifionly,nativefilterallow,nativefilterblock,cpualwayspartiallock,forcewifi,email,loglevel,startwithos",me=20,le=!0,ge=!1,pe=[],de=!1,ue=3,_e="#menuitem_settings_level",ve="#menuitem_show_settings",he="#menuitem_settings_search",fe="#menuitem_settings_help",be="#menuitem_settings_exit",Pe="#menuitem_settings_proversion",we="#menuitem_settings_logs_custom",Ee="menuitem_settings_speedtest",ke=!1,Se="",Te={SaveSettings:P};return window.settings_public=Te,{onCreate:e,onStart:t,onStop:O,onDestroy:A}}();